<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Supplemental | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Supplemental | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Supplemental | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="em.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#create-the-weights"><i class="fa fa-check"></i>Create the Weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#demonstrate-censoring-with-an-upper-limit"><i class="fa fa-check"></i>Demonstrate Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#demonstrate-censoring-with-a-lower-limit"><i class="fa fa-check"></i>Demonstrate censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Chain Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#median-estimation"><i class="fa fa-check"></i>Median estimation</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gausian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-17"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-21"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-19"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-23"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-22"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayes-non-parametric.html"><a href="bayes-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayes-non-parametric.html"><a href="bayes-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayes-non-parametric.html"><a href="bayes-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Placeholder</a></li>
<li class="part"><span><b>Algorithms</b></span></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#functions-9"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#estimation-21"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#functions-10"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-11"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-27"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-3"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-function"><i class="fa fa-check"></i>Example Function</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful-eruptions"><i class="fa fa-check"></i>Example 1: Old Faithful eruptions</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris-data-set"><i class="fa fa-check"></i>Example 2: Iris data set</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-25"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-26"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-3"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#algorithms"><i class="fa fa-check"></i>Algorithms</a></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supplemental" class="section level1">
<h1>Supplemental</h1>
<p><strong>IN PROGRESS</strong></p>
<div id="other-languages" class="section level2">
<h2>Other Languages</h2>
<p>When doing some of these models and algorithms, I had some other code to work with in another language, or, at the time, just wanted to try it in that language. Not much here but may be useful to some. Refer to the corresponding chapter of R code for context.</p>
<div id="julia" class="section level4">
<h4>Julia</h4>
<p>I haven’t played with Julia in a very long time, but briefly hacked the old code to get something that worked. As Julia has gone though notable changes, it’s doubtful these are very good as far as Julia code goes, though conceptually they may still provide some utility. Perhaps at some point I’ll reteach myself the basics and come back to these. In any case the code did run on a <a href="https://jupyter.org/">Jupyter notebook</a>.</p>
<div id="mixed-models" class="section level5">
<h5>Mixed Models</h5>
<div id="one-factor" class="section level6">
<h6>One-factor</h6>
<div class="sourceCode" id="cb678"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb678-1"><a href="supplemental.html#cb678-1"></a><span class="co">#####################</span></span>
<span id="cb678-2"><a href="supplemental.html#cb678-2"></a><span class="co">### Main function </span><span class="al">###</span></span>
<span id="cb678-3"><a href="supplemental.html#cb678-3"></a><span class="co">#####################</span></span>
<span id="cb678-4"><a href="supplemental.html#cb678-4"></a></span>
<span id="cb678-5"><a href="supplemental.html#cb678-5"></a><span class="kw">using</span> LinearAlgebra</span>
<span id="cb678-6"><a href="supplemental.html#cb678-6"></a><span class="kw">using</span> Statistics</span>
<span id="cb678-7"><a href="supplemental.html#cb678-7"></a></span>
<span id="cb678-8"><a href="supplemental.html#cb678-8"></a><span class="kw">function</span> one_factor_re_loglike(par<span class="op">::</span><span class="dt">Vector</span>)    </span>
<span id="cb678-9"><a href="supplemental.html#cb678-9"></a>    d<span class="op">,</span> ni <span class="op">=</span> size(y)</span>
<span id="cb678-10"><a href="supplemental.html#cb678-10"></a>    mu <span class="op">=</span> par[<span class="fl">1</span>]</span>
<span id="cb678-11"><a href="supplemental.html#cb678-11"></a>    sigma2_mu <span class="op">=</span> par[<span class="fl">2</span>]</span>
<span id="cb678-12"><a href="supplemental.html#cb678-12"></a>    sigma2 <span class="op">=</span> par[<span class="fl">3</span>]</span>
<span id="cb678-13"><a href="supplemental.html#cb678-13"></a></span>
<span id="cb678-14"><a href="supplemental.html#cb678-14"></a>    Sigmai <span class="op">=</span> sigma2<span class="op">*</span>I(ni) <span class="op">+</span> sigma2_mu<span class="op">*</span>ones(ni<span class="op">,</span> ni)</span>
<span id="cb678-15"><a href="supplemental.html#cb678-15"></a>    l <span class="op">=</span> <span class="op">-</span>(ni<span class="op">*</span>d)<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(<span class="fl">2</span><span class="op">*</span><span class="cn">pi</span>) <span class="op">-</span> d<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(det(Sigmai))</span>
<span id="cb678-16"><a href="supplemental.html#cb678-16"></a>    </span>
<span id="cb678-17"><a href="supplemental.html#cb678-17"></a>    <span class="kw">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>d</span>
<span id="cb678-18"><a href="supplemental.html#cb678-18"></a>      yi <span class="op">=</span> y[i<span class="op">,:</span>]</span>
<span id="cb678-19"><a href="supplemental.html#cb678-19"></a>      l <span class="op">=</span> l <span class="op">-</span> <span class="fl">.5</span>(yi .<span class="op">-</span> mu)<span class="op">&#39;</span> <span class="op">*</span> (Sigmai<span class="op">\</span>(yi .<span class="op">-</span> mu))</span>
<span id="cb678-20"><a href="supplemental.html#cb678-20"></a>    <span class="kw">end</span></span>
<span id="cb678-21"><a href="supplemental.html#cb678-21"></a></span>
<span id="cb678-22"><a href="supplemental.html#cb678-22"></a>    l <span class="op">=</span> <span class="op">-</span>l[<span class="fl">1</span>]</span>
<span id="cb678-23"><a href="supplemental.html#cb678-23"></a>    </span>
<span id="cb678-24"><a href="supplemental.html#cb678-24"></a>    <span class="kw">return</span> l</span>
<span id="cb678-25"><a href="supplemental.html#cb678-25"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb679"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb679-1"><a href="supplemental.html#cb679-1"></a><span class="co">###################</span></span>
<span id="cb679-2"><a href="supplemental.html#cb679-2"></a><span class="co">### Data set up </span><span class="al">###</span></span>
<span id="cb679-3"><a href="supplemental.html#cb679-3"></a><span class="co">###################</span></span>
<span id="cb679-4"><a href="supplemental.html#cb679-4"></a></span>
<span id="cb679-5"><a href="supplemental.html#cb679-5"></a>y <span class="op">=</span> [<span class="fl">22.6</span> <span class="fl">20.5</span> <span class="fl">20.8</span></span>
<span id="cb679-6"><a href="supplemental.html#cb679-6"></a>     <span class="fl">22.6</span> <span class="fl">21.2</span> <span class="fl">20.5</span></span>
<span id="cb679-7"><a href="supplemental.html#cb679-7"></a>     <span class="fl">17.3</span> <span class="fl">16.2</span> <span class="fl">16.6</span></span>
<span id="cb679-8"><a href="supplemental.html#cb679-8"></a>     <span class="fl">21.4</span> <span class="fl">23.7</span> <span class="fl">23.2</span></span>
<span id="cb679-9"><a href="supplemental.html#cb679-9"></a>     <span class="fl">20.9</span> <span class="fl">22.2</span> <span class="fl">22.6</span></span>
<span id="cb679-10"><a href="supplemental.html#cb679-10"></a>     <span class="fl">14.5</span> <span class="fl">10.5</span> <span class="fl">12.3</span></span>
<span id="cb679-11"><a href="supplemental.html#cb679-11"></a>     <span class="fl">20.8</span> <span class="fl">19.1</span> <span class="fl">21.3</span></span>
<span id="cb679-12"><a href="supplemental.html#cb679-12"></a>     <span class="fl">17.4</span> <span class="fl">18.6</span> <span class="fl">18.6</span></span>
<span id="cb679-13"><a href="supplemental.html#cb679-13"></a>     <span class="fl">25.1</span> <span class="fl">24.8</span> <span class="fl">24.9</span></span>
<span id="cb679-14"><a href="supplemental.html#cb679-14"></a>     <span class="fl">14.9</span> <span class="fl">16.3</span> <span class="fl">16.6</span>]</span>
<span id="cb679-15"><a href="supplemental.html#cb679-15"></a></span>
<span id="cb679-16"><a href="supplemental.html#cb679-16"></a></span>
<span id="cb679-17"><a href="supplemental.html#cb679-17"></a><span class="co">################################</span></span>
<span id="cb679-18"><a href="supplemental.html#cb679-18"></a><span class="co">### Starting values and test </span><span class="al">###</span></span>
<span id="cb679-19"><a href="supplemental.html#cb679-19"></a><span class="co">################################</span></span>
<span id="cb679-20"><a href="supplemental.html#cb679-20"></a><span class="kw">using</span> Statistics</span>
<span id="cb679-21"><a href="supplemental.html#cb679-21"></a></span>
<span id="cb679-22"><a href="supplemental.html#cb679-22"></a>mu0 <span class="op">=</span> mean(y)</span>
<span id="cb679-23"><a href="supplemental.html#cb679-23"></a>sigma2_mu0 <span class="op">=</span> var(mean(y<span class="op">,</span> dims <span class="op">=</span> <span class="fl">2</span>))</span>
<span id="cb679-24"><a href="supplemental.html#cb679-24"></a>sigma20 <span class="op">=</span> mean(var(y<span class="op">,</span> dims <span class="op">=</span> <span class="fl">2</span>))</span>
<span id="cb679-25"><a href="supplemental.html#cb679-25"></a>theta0  <span class="op">=</span> [mu0<span class="op">,</span> sigma2_mu0<span class="op">,</span> sigma20]</span>
<span id="cb679-26"><a href="supplemental.html#cb679-26"></a></span>
<span id="cb679-27"><a href="supplemental.html#cb679-27"></a><span class="co">### test</span></span>
<span id="cb679-28"><a href="supplemental.html#cb679-28"></a>one_factor_re_loglike(theta0)</span></code></pre></div>
<div class="sourceCode" id="cb680"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb680-1"><a href="supplemental.html#cb680-1"></a><span class="co">###########</span></span>
<span id="cb680-2"><a href="supplemental.html#cb680-2"></a><span class="co">### Run </span><span class="al">###</span></span>
<span id="cb680-3"><a href="supplemental.html#cb680-3"></a><span class="co">###########</span></span>
<span id="cb680-4"><a href="supplemental.html#cb680-4"></a></span>
<span id="cb680-5"><a href="supplemental.html#cb680-5"></a><span class="kw">using</span> Optim</span>
<span id="cb680-6"><a href="supplemental.html#cb680-6"></a>res <span class="op">=</span> optimize(one_factor_re_loglike<span class="op">,</span> theta0<span class="op">,</span> LBFGS())</span>
<span id="cb680-7"><a href="supplemental.html#cb680-7"></a>res</span></code></pre></div>
<pre><code>
 * Status: success

 * Candidate solution
    Final objective value:     6.226441e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 2.93e-08 ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = 1.49e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 1.42e-14 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 2.28e-16 ≰ 0.0e+00
    |g(x)|                 = 1.17e-09 ≤ 1.0e-08

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    7
    f(x) calls:    22
    ∇f(x) calls:   22
  
  </code></pre>
<div class="sourceCode" id="cb682"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb682-1"><a href="supplemental.html#cb682-1"></a>Optim.minimizer(res)</span></code></pre></div>
<pre><code>
3-element Array{Float64,1}:
19.599999980440952
12.193999992338886
1.1666666662195693</code></pre>
<div class="sourceCode" id="cb684"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb684-1"><a href="supplemental.html#cb684-1"></a>Optim.minimum(res)</span></code></pre></div>
<pre><code>62.30661224610756</code></pre>
</div>
<div id="two-factor" class="section level6">
<h6>Two-factor</h6>
<div class="sourceCode" id="cb686"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb686-1"><a href="supplemental.html#cb686-1"></a><span class="kw">using</span> LinearAlgebra</span>
<span id="cb686-2"><a href="supplemental.html#cb686-2"></a><span class="kw">using</span> Statistics</span>
<span id="cb686-3"><a href="supplemental.html#cb686-3"></a></span>
<span id="cb686-4"><a href="supplemental.html#cb686-4"></a><span class="kw">function</span> sfran2_loglike(par<span class="op">::</span><span class="dt">Vector</span>)</span>
<span id="cb686-5"><a href="supplemental.html#cb686-5"></a>    n <span class="op">=</span> length(y)</span>
<span id="cb686-6"><a href="supplemental.html#cb686-6"></a>    mu <span class="op">=</span> par[<span class="fl">1</span>]</span>
<span id="cb686-7"><a href="supplemental.html#cb686-7"></a>    </span>
<span id="cb686-8"><a href="supplemental.html#cb686-8"></a>    sigma2_alpha <span class="op">=</span> exp(par[<span class="fl">2</span>])</span>
<span id="cb686-9"><a href="supplemental.html#cb686-9"></a>    sigma2_gamma <span class="op">=</span> exp(par[<span class="fl">3</span>])</span>
<span id="cb686-10"><a href="supplemental.html#cb686-10"></a>    sigma2 <span class="op">=</span> exp(par[<span class="fl">4</span>])</span>
<span id="cb686-11"><a href="supplemental.html#cb686-11"></a></span>
<span id="cb686-12"><a href="supplemental.html#cb686-12"></a>    Sigma <span class="op">=</span> sigma2<span class="op">*</span>I(n) <span class="op">+</span> sigma2_alpha<span class="op">*</span>(Xalpha <span class="op">*</span> Xalpha<span class="op">&#39;</span>) <span class="op">+</span> sigma2_gamma <span class="op">*</span> (Xgamma <span class="op">*</span> Xgamma<span class="op">&#39;</span>)</span>
<span id="cb686-13"><a href="supplemental.html#cb686-13"></a></span>
<span id="cb686-14"><a href="supplemental.html#cb686-14"></a>    l <span class="op">=</span> <span class="op">-</span>n<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(<span class="fl">2</span><span class="op">*</span><span class="cn">pi</span>) <span class="op">-</span> sum(log.(diag(cholesky(Sigma).L))) <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(y .<span class="op">-</span> mu)<span class="op">&#39;</span> <span class="op">*</span> (Sigma<span class="op">\</span>(y .<span class="op">-</span> mu))</span>
<span id="cb686-15"><a href="supplemental.html#cb686-15"></a></span>
<span id="cb686-16"><a href="supplemental.html#cb686-16"></a>    l <span class="op">=</span> <span class="op">-</span>l[<span class="fl">1</span>]</span>
<span id="cb686-17"><a href="supplemental.html#cb686-17"></a>    <span class="kw">return</span> l</span>
<span id="cb686-18"><a href="supplemental.html#cb686-18"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb687"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb687-1"><a href="supplemental.html#cb687-1"></a><span class="co">##################</span></span>
<span id="cb687-2"><a href="supplemental.html#cb687-2"></a><span class="co">### Data setup </span><span class="al">###</span></span>
<span id="cb687-3"><a href="supplemental.html#cb687-3"></a><span class="co">##################</span></span>
<span id="cb687-4"><a href="supplemental.html#cb687-4"></a>y <span class="op">=</span> [<span class="fl">1.39</span><span class="op">,</span><span class="fl">1.29</span><span class="op">,</span><span class="fl">1.12</span><span class="op">,</span><span class="fl">1.16</span><span class="op">,</span><span class="fl">1.52</span><span class="op">,</span><span class="fl">1.62</span><span class="op">,</span><span class="fl">1.88</span><span class="op">,</span><span class="fl">1.87</span><span class="op">,</span><span class="fl">1.24</span><span class="op">,</span><span class="fl">1.18</span><span class="op">,</span></span>
<span id="cb687-5"><a href="supplemental.html#cb687-5"></a>     <span class="fl">.95</span><span class="op">,</span><span class="fl">.96</span><span class="op">,</span><span class="fl">.82</span><span class="op">,</span><span class="fl">.92</span><span class="op">,</span><span class="fl">1.18</span><span class="op">,</span><span class="fl">1.20</span><span class="op">,</span><span class="fl">1.47</span><span class="op">,</span><span class="fl">1.41</span><span class="op">,</span><span class="fl">1.57</span><span class="op">,</span><span class="fl">1.65</span>]</span>
<span id="cb687-6"><a href="supplemental.html#cb687-6"></a></span>
<span id="cb687-7"><a href="supplemental.html#cb687-7"></a></span>
<span id="cb687-8"><a href="supplemental.html#cb687-8"></a><span class="co">################################</span></span>
<span id="cb687-9"><a href="supplemental.html#cb687-9"></a><span class="co">### Starting values and test </span><span class="al">###</span></span>
<span id="cb687-10"><a href="supplemental.html#cb687-10"></a><span class="co">################################</span></span>
<span id="cb687-11"><a href="supplemental.html#cb687-11"></a>yhat <span class="op">=</span> mean(reshape(y<span class="op">,</span> <span class="fl">4</span><span class="op">,</span> <span class="fl">5</span>)<span class="op">,</span> <span class="fl">1</span>)</span>
<span id="cb687-12"><a href="supplemental.html#cb687-12"></a></span>
<span id="cb687-13"><a href="supplemental.html#cb687-13"></a>theta0 <span class="op">=</span> [mean(y)<span class="op">,</span> log(var(yhat))<span class="op">,</span> log(var(y)<span class="op">/</span><span class="fl">3</span>)<span class="op">,</span> log(var(y)<span class="op">/</span><span class="fl">3</span>)]</span>
<span id="cb687-14"><a href="supplemental.html#cb687-14"></a></span>
<span id="cb687-15"><a href="supplemental.html#cb687-15"></a>sfran2_loglike(theta0)</span></code></pre></div>
<div class="sourceCode" id="cb688"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb688-1"><a href="supplemental.html#cb688-1"></a><span class="co">###########</span></span>
<span id="cb688-2"><a href="supplemental.html#cb688-2"></a><span class="co">### Run </span><span class="al">###</span></span>
<span id="cb688-3"><a href="supplemental.html#cb688-3"></a><span class="co">###########</span></span>
<span id="cb688-4"><a href="supplemental.html#cb688-4"></a><span class="kw">using</span> Optim</span>
<span id="cb688-5"><a href="supplemental.html#cb688-5"></a>res <span class="op">=</span> optimize(sfran2_loglike<span class="op">,</span> theta0<span class="op">,</span> method <span class="op">=</span> <span class="op">:</span>l_bfgs)</span>
<span id="cb688-6"><a href="supplemental.html#cb688-6"></a>res</span></code></pre></div>
<pre><code>
 * Status: success

 * Candidate solution
    Final objective value:     -1.199315e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 6.60e-09 ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = 1.08e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 5.33e-15 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 4.44e-16 ≰ 0.0e+00
    |g(x)|                 = 7.02e-10 ≤ 1.0e-08

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    9
    f(x) calls:    23
    ∇f(x) calls:   23</code></pre>
<div class="sourceCode" id="cb690"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb690-1"><a href="supplemental.html#cb690-1"></a>exp.(Optim.minimizer(res))</span></code></pre></div>
<pre><code>
4-element Array{Float64,1}:
 3.7434213772629223
 0.053720000000540405
 0.031790000003692476
 0.002290000000530042</code></pre>
<div class="sourceCode" id="cb692"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb692-1"><a href="supplemental.html#cb692-1"></a><span class="op">-</span><span class="fl">2</span><span class="op">*</span>Optim.minimum(res)</span></code></pre></div>
<pre><code>23.98630759443859</code></pre>
</div>
</div>
</div>
<div id="matlab" class="section level4">
<h4>Matlab</h4>
<p>I don’t code in Matlab, nor have any particular desire to, so this is provided here just for reference.</p>
<div id="mixed-models-1" class="section level5">
<h5>Mixed Models</h5>
<div id="one-factor-1" class="section level6">
<h6>One-factor</h6>
<div class="sourceCode" id="cb694"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb694-1"><a href="supplemental.html#cb694-1"></a><span class="co">% matlab from Statistical Modeling and Computation (2014 p 311).  See the </span></span>
<span id="cb694-2"><a href="supplemental.html#cb694-2"></a><span class="co">% associated twofactorRE.R file for details.</span></span>
<span id="cb694-3"><a href="supplemental.html#cb694-3"></a></span>
<span id="cb694-4"><a href="supplemental.html#cb694-4"></a><span class="kw">function</span> <span class="va">one_factor_re_loglike</span>(<span class="va">mu</span><span class="op">,</span> <span class="va">sigma2_mu</span><span class="op">,</span> <span class="va">sigma2</span><span class="op">,</span> <span class="va">y</span>)</span>
<span id="cb694-5"><a href="supplemental.html#cb694-5"></a>    [<span class="va">d</span> <span class="va">ni</span>] <span class="op">=</span> <span class="va">size</span>(<span class="va">y</span>)<span class="op">;</span></span>
<span id="cb694-6"><a href="supplemental.html#cb694-6"></a>    <span class="va">Sigmai</span> <span class="op">=</span> <span class="va">sigma2</span><span class="op">*</span><span class="va">eye</span>(<span class="va">ni</span>) <span class="op">+</span> <span class="va">sigma2_mu</span><span class="op">*</span><span class="va">ones</span>(<span class="va">ni</span><span class="op">,</span><span class="va">ni</span>)<span class="op">;</span></span>
<span id="cb694-7"><a href="supplemental.html#cb694-7"></a>    <span class="va">l</span> <span class="op">=</span> <span class="op">-</span>(<span class="va">ni</span><span class="op">*</span><span class="va">d</span>) <span class="op">/</span> <span class="fl">2</span><span class="op">*</span><span class="va">log</span>(<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>) <span class="op">-</span> <span class="va">d</span> <span class="op">/</span> <span class="fl">2</span><span class="op">*</span><span class="va">log</span>(<span class="va">det</span>(<span class="va">Sigmai</span>))<span class="op">;</span></span>
<span id="cb694-8"><a href="supplemental.html#cb694-8"></a>    <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span></span>
<span id="cb694-9"><a href="supplemental.html#cb694-9"></a>      <span class="va">yi</span> <span class="op">=</span> <span class="va">y</span>(<span class="va">i</span><span class="op">,</span> <span class="op">:</span>)<span class="op">&#39;;</span></span>
<span id="cb694-10"><a href="supplemental.html#cb694-10"></a>      <span class="va">l</span> <span class="op">=</span> <span class="va">l</span> <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(<span class="va">yi</span> <span class="op">-</span> <span class="va">mu</span>)<span class="op">&#39;</span> <span class="op">*</span> (<span class="va">Sigmai</span><span class="op">\</span>(<span class="va">yi</span> <span class="op">-</span> <span class="va">mu</span>))<span class="op">;</span></span>
<span id="cb694-11"><a href="supplemental.html#cb694-11"></a>    <span class="kw">end</span></span>
<span id="cb694-12"><a href="supplemental.html#cb694-12"></a><span class="kw">end</span></span>
<span id="cb694-13"><a href="supplemental.html#cb694-13"></a></span>
<span id="cb694-14"><a href="supplemental.html#cb694-14"></a></span>
<span id="cb694-15"><a href="supplemental.html#cb694-15"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">22.6</span> <span class="fl">20.5</span> <span class="fl">20.8</span><span class="op">;</span></span>
<span id="cb694-16"><a href="supplemental.html#cb694-16"></a>     <span class="fl">22.6</span> <span class="fl">21.2</span> <span class="fl">20.5</span><span class="op">;</span></span>
<span id="cb694-17"><a href="supplemental.html#cb694-17"></a>     <span class="fl">17.3</span> <span class="fl">16.2</span> <span class="fl">16.6</span><span class="op">;</span></span>
<span id="cb694-18"><a href="supplemental.html#cb694-18"></a>     <span class="fl">21.4</span> <span class="fl">23.7</span> <span class="fl">23.2</span><span class="op">;</span></span>
<span id="cb694-19"><a href="supplemental.html#cb694-19"></a>     <span class="fl">20.9</span> <span class="fl">22.2</span> <span class="fl">22.6</span><span class="op">;</span></span>
<span id="cb694-20"><a href="supplemental.html#cb694-20"></a>     <span class="fl">14.5</span> <span class="fl">10.5</span> <span class="fl">12.3</span><span class="op">;</span></span>
<span id="cb694-21"><a href="supplemental.html#cb694-21"></a>     <span class="fl">20.8</span> <span class="fl">19.1</span> <span class="fl">21.3</span><span class="op">;</span></span>
<span id="cb694-22"><a href="supplemental.html#cb694-22"></a>     <span class="fl">17.4</span> <span class="fl">18.6</span> <span class="fl">18.6</span><span class="op">;</span></span>
<span id="cb694-23"><a href="supplemental.html#cb694-23"></a>     <span class="fl">25.1</span> <span class="fl">24.8</span> <span class="fl">24.9</span><span class="op">;</span></span>
<span id="cb694-24"><a href="supplemental.html#cb694-24"></a>     <span class="fl">14.9</span> <span class="fl">16.3</span> <span class="fl">16.6</span>]<span class="op">;</span></span>
<span id="cb694-25"><a href="supplemental.html#cb694-25"></a></span>
<span id="cb694-26"><a href="supplemental.html#cb694-26"></a></span>
<span id="cb694-27"><a href="supplemental.html#cb694-27"></a><span class="va">f</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">theta</span>) <span class="op">-</span><span class="va">one_factor_re_loglike</span>(<span class="va">theta</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">2</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="va">y</span>)<span class="op">;</span></span>
<span id="cb694-28"><a href="supplemental.html#cb694-28"></a><span class="va">ybar</span> <span class="op">=</span> <span class="va">mean</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb694-29"><a href="supplemental.html#cb694-29"></a><span class="va">theta0</span> <span class="op">=</span> [<span class="va">mean</span>(<span class="va">ybar</span>) <span class="va">var</span>(<span class="va">ybar</span>) <span class="va">mean</span>(<span class="va">var</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">2</span>))]<span class="op">;</span></span>
<span id="cb694-30"><a href="supplemental.html#cb694-30"></a><span class="va">thetahat</span> <span class="op">=</span> <span class="va">fminsearch</span>(<span class="va">f</span><span class="op">,</span> <span class="va">theta0</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="two-factor-1" class="section level6">
<h6>Two-factor</h6>
<div class="sourceCode" id="cb695"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb695-1"><a href="supplemental.html#cb695-1"></a><span class="co">% matlab from Statistical Modeling and Computation (2014 p 314). See the </span></span>
<span id="cb695-2"><a href="supplemental.html#cb695-2"></a><span class="co">% associated twofactorRE.R file for details.</span></span>
<span id="cb695-3"><a href="supplemental.html#cb695-3"></a></span>
<span id="cb695-4"><a href="supplemental.html#cb695-4"></a><span class="kw">function</span> <span class="va">sfran2_loglike</span>(<span class="va">mu</span><span class="op">,</span> <span class="va">eta_alpha</span><span class="op">,</span> <span class="va">eta_gamma</span><span class="op">,</span> <span class="va">eta</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">Xalpha</span><span class="op">,</span> <span class="va">Xgamma</span>)</span>
<span id="cb695-5"><a href="supplemental.html#cb695-5"></a>  <span class="va">sigma2_alpha</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta_alpha</span>)<span class="op">;</span></span>
<span id="cb695-6"><a href="supplemental.html#cb695-6"></a>  <span class="va">sigma2_gamma</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta_gamma</span>)<span class="op">;</span></span>
<span id="cb695-7"><a href="supplemental.html#cb695-7"></a>  <span class="va">sigma2</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta</span>)<span class="op">;</span></span>
<span id="cb695-8"><a href="supplemental.html#cb695-8"></a>  </span>
<span id="cb695-9"><a href="supplemental.html#cb695-9"></a>  <span class="va">n</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">y</span>)<span class="op">;</span></span>
<span id="cb695-10"><a href="supplemental.html#cb695-10"></a>  </span>
<span id="cb695-11"><a href="supplemental.html#cb695-11"></a>  <span class="va">Sigma</span> <span class="op">=</span> <span class="va">sigma2</span><span class="op">*</span><span class="va">speye</span>(<span class="va">n</span>) <span class="op">+</span> <span class="va">sigma2_alpha</span> <span class="op">*</span> (<span class="va">Xalpha</span> <span class="op">*</span> <span class="va">Xalpha</span><span class="op">&#39;</span>) <span class="op">+</span> <span class="va">sigma2_gamma</span> <span class="op">*</span> (<span class="va">Xgamma</span><span class="op">*</span><span class="va">Xgamma</span><span class="op">&#39;</span>)<span class="op">;</span></span>
<span id="cb695-12"><a href="supplemental.html#cb695-12"></a>  </span>
<span id="cb695-13"><a href="supplemental.html#cb695-13"></a>  <span class="va">l</span> <span class="op">=</span> <span class="op">-</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span> <span class="op">*</span> <span class="va">log</span>(<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>) <span class="op">-</span> <span class="va">sum</span>(<span class="va">log</span>(<span class="va">diag</span>(<span class="va">chol</span>(<span class="va">Sigma</span>)))) <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(<span class="va">y</span> <span class="op">-</span> <span class="va">mu</span>)<span class="op">&#39;</span> <span class="op">*</span> (<span class="va">Sigma</span><span class="op">\</span>(<span class="va">y</span> <span class="op">-</span> <span class="va">mu</span>))<span class="op">;</span></span>
<span id="cb695-14"><a href="supplemental.html#cb695-14"></a>  </span>
<span id="cb695-15"><a href="supplemental.html#cb695-15"></a><span class="kw">end</span></span>
<span id="cb695-16"><a href="supplemental.html#cb695-16"></a></span>
<span id="cb695-17"><a href="supplemental.html#cb695-17"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">1.39</span> <span class="fl">1.29</span> <span class="fl">1.12</span> <span class="fl">1.16</span> <span class="fl">1.52</span> <span class="fl">1.62</span> <span class="fl">1.88</span> <span class="fl">1.87</span> <span class="fl">1.24</span> <span class="fl">1.18</span> <span class="fl">.95</span> <span class="fl">.96</span> <span class="fl">.82</span> <span class="fl">.92</span> <span class="fl">1.18</span> <span class="fl">1.20</span> <span class="fl">1.47</span> <span class="fl">1.41</span> <span class="fl">1.57</span> <span class="fl">1.65</span>]<span class="op">;</span></span>
<span id="cb695-18"><a href="supplemental.html#cb695-18"></a></span>
<span id="cb695-19"><a href="supplemental.html#cb695-19"></a><span class="va">Xalpha</span> <span class="op">=</span> <span class="va">kron</span>(<span class="va">speye</span>(<span class="fl">5</span>)<span class="op">,</span>  <span class="va">ones</span>(<span class="fl">4</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb695-20"><a href="supplemental.html#cb695-20"></a></span>
<span id="cb695-21"><a href="supplemental.html#cb695-21"></a><span class="va">Xgamma</span> <span class="op">=</span> <span class="va">kron</span>(<span class="va">speye</span>(<span class="fl">10</span>)<span class="op">,</span> <span class="va">ones</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb695-22"><a href="supplemental.html#cb695-22"></a></span>
<span id="cb695-23"><a href="supplemental.html#cb695-23"></a><span class="va">f</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">theta</span>) <span class="op">-</span><span class="va">sfran_loglike</span>(<span class="va">theta</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">2</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">4</span>)<span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">Xalpha</span><span class="op">,</span> <span class="va">Xgamma</span>)<span class="op">;</span></span>
<span id="cb695-24"><a href="supplemental.html#cb695-24"></a><span class="va">yhat</span>     <span class="op">=</span> <span class="va">mean</span>(<span class="va">reshape</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span> <span class="fl">5</span>))<span class="op">;</span></span>
<span id="cb695-25"><a href="supplemental.html#cb695-25"></a><span class="va">theta0</span>   <span class="op">=</span> [<span class="va">mean</span>(<span class="va">y</span>) <span class="va">log</span>(<span class="va">var</span>(<span class="va">yhat</span>)) <span class="va">log</span>(<span class="va">var</span>(<span class="va">y</span>)<span class="op">/</span><span class="fl">3</span>) <span class="va">log</span>(<span class="va">var</span>(<span class="va">y</span>)<span class="op">/</span><span class="fl">3</span>)]<span class="op">;</span></span>
<span id="cb695-26"><a href="supplemental.html#cb695-26"></a><span class="va">thetahat</span> <span class="op">=</span> <span class="va">fminsearch</span>(<span class="va">f</span><span class="op">,</span> <span class="va">theta0</span>)</span></code></pre></div>
</div>
</div>
<div id="gaussian-processes" class="section level5">
<h5>Gaussian Processes</h5>
<p>Any updates on the following can be found at the <a href="https://github.com/probml/pmtk3">repo</a>.</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb696-1"><a href="supplemental.html#cb696-1"></a><span class="kw">function</span> <span class="va">S</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">arg1</span><span class="op">,</span> <span class="va">arg2</span><span class="op">,</span> <span class="va">arg3</span>)</span>
<span id="cb696-2"><a href="supplemental.html#cb696-2"></a><span class="co">% Returns n samples (in the rows) from a multivariate Gaussian distribution</span></span>
<span id="cb696-3"><a href="supplemental.html#cb696-3"></a><span class="co">%</span></span>
<span id="cb696-4"><a href="supplemental.html#cb696-4"></a><span class="co">% Examples:</span></span>
<span id="cb696-5"><a href="supplemental.html#cb696-5"></a><span class="co">% S = gaussSample(mu, Sigma, 10)</span></span>
<span id="cb696-6"><a href="supplemental.html#cb696-6"></a><span class="co">% S = gaussSample(model, 100)</span></span>
<span id="cb696-7"><a href="supplemental.html#cb696-7"></a><span class="co">% S = gaussSample(struct(&#39;mu&#39;,[0], &#39;Sigma&#39;, eye(1)), 3)</span></span>
<span id="cb696-8"><a href="supplemental.html#cb696-8"></a></span>
<span id="cb696-9"><a href="supplemental.html#cb696-9"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb696-10"><a href="supplemental.html#cb696-10"></a></span>
<span id="cb696-11"><a href="supplemental.html#cb696-11"></a></span>
<span id="cb696-12"><a href="supplemental.html#cb696-12"></a><span class="kw">switch</span> <span class="va">nargin</span></span>
<span id="cb696-13"><a href="supplemental.html#cb696-13"></a>    <span class="kw">case</span> <span class="fl">3</span><span class="op">,</span>  <span class="va">mu</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">arg2</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="va">arg3</span><span class="op">;</span></span>
<span id="cb696-14"><a href="supplemental.html#cb696-14"></a>    <span class="kw">case</span> <span class="fl">2</span><span class="op">,</span> <span class="va">model</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">mu</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">mu</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">Sigma</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="va">arg2</span><span class="op">;</span></span>
<span id="cb696-15"><a href="supplemental.html#cb696-15"></a>    <span class="kw">case</span> <span class="fl">1</span><span class="op">,</span> <span class="va">model</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">mu</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">mu</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">Sigma</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span> </span>
<span id="cb696-16"><a href="supplemental.html#cb696-16"></a>    <span class="kw">otherwise</span></span>
<span id="cb696-17"><a href="supplemental.html#cb696-17"></a>        <span class="va">error</span>(<span class="ss">&#39;bad num args&#39;</span>)</span>
<span id="cb696-18"><a href="supplemental.html#cb696-18"></a><span class="kw">end</span></span>
<span id="cb696-19"><a href="supplemental.html#cb696-19"></a></span>
<span id="cb696-20"><a href="supplemental.html#cb696-20"></a><span class="va">A</span> <span class="op">=</span> <span class="va">chol</span>(<span class="va">Sigma</span><span class="op">,</span> <span class="ss">&#39;lower&#39;</span>)<span class="op">;</span></span>
<span id="cb696-21"><a href="supplemental.html#cb696-21"></a><span class="va">Z</span> <span class="op">=</span> <span class="va">randn</span>(<span class="va">length</span>(<span class="va">mu</span>)<span class="op">,</span> <span class="va">n</span>)<span class="op">;</span></span>
<span id="cb696-22"><a href="supplemental.html#cb696-22"></a><span class="va">S</span> <span class="op">=</span> <span class="va">bsxfun</span>(<span class="op">@</span><span class="va">plus</span><span class="op">,</span> <span class="va">mu</span>(<span class="op">:</span>)<span class="op">,</span> <span class="va">A</span><span class="op">*</span><span class="va">Z</span>)<span class="op">&#39;;</span></span>
<span id="cb696-23"><a href="supplemental.html#cb696-23"></a></span>
<span id="cb696-24"><a href="supplemental.html#cb696-24"></a></span>
<span id="cb696-25"><a href="supplemental.html#cb696-25"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb697"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb697-1"><a href="supplemental.html#cb697-1"></a><span class="co">%% Visualize the effect of change the hyper-params for a 1d GP regression</span></span>
<span id="cb697-2"><a href="supplemental.html#cb697-2"></a><span class="co">% based on demo_gpr by Carl Rasmussen</span></span>
<span id="cb697-3"><a href="supplemental.html#cb697-3"></a><span class="co">%</span></span>
<span id="cb697-4"><a href="supplemental.html#cb697-4"></a><span class="co">%% Generate data</span></span>
<span id="cb697-5"><a href="supplemental.html#cb697-5"></a></span>
<span id="cb697-6"><a href="supplemental.html#cb697-6"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb697-7"><a href="supplemental.html#cb697-7"></a></span>
<span id="cb697-8"><a href="supplemental.html#cb697-8"></a><span class="va">n</span> <span class="op">=</span> <span class="fl">20</span><span class="op">;</span></span>
<span id="cb697-9"><a href="supplemental.html#cb697-9"></a><span class="va">rand</span>(<span class="ss">&#39;state&#39;</span><span class="op">,</span><span class="fl">18</span>)<span class="op">;</span></span>
<span id="cb697-10"><a href="supplemental.html#cb697-10"></a><span class="va">randn</span>(<span class="ss">&#39;state&#39;</span><span class="op">,</span><span class="fl">20</span>)<span class="op">;</span></span>
<span id="cb697-11"><a href="supplemental.html#cb697-11"></a><span class="va">covfunc</span> <span class="op">=</span> {<span class="ss">&#39;covSum&#39;</span><span class="op">,</span> {<span class="ss">&#39;covSEiso&#39;</span><span class="op">,</span><span class="ss">&#39;covNoise&#39;</span>}}<span class="op">;</span></span>
<span id="cb697-12"><a href="supplemental.html#cb697-12"></a><span class="va">loghyper</span> <span class="op">=</span> [<span class="va">log</span>(<span class="fl">1.0</span>)<span class="op">;</span> <span class="va">log</span>(<span class="fl">1.0</span>)<span class="op">;</span> <span class="va">log</span>(<span class="fl">0.1</span>)]<span class="op">;</span></span>
<span id="cb697-13"><a href="supplemental.html#cb697-13"></a><span class="va">x</span> <span class="op">=</span> <span class="fl">15</span><span class="op">*</span>(<span class="va">rand</span>(<span class="va">n</span><span class="op">,</span><span class="fl">1</span>)<span class="op">-</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb697-14"><a href="supplemental.html#cb697-14"></a><span class="va">y</span> <span class="op">=</span> <span class="va">chol</span>(<span class="va">feval</span>(<span class="va">covfunc</span>{<span class="op">:</span>}<span class="op">,</span> <span class="va">loghyper</span><span class="op">,</span> <span class="va">x</span>))<span class="op">&#39;*</span><span class="va">randn</span>(<span class="va">n</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span>        <span class="co">% Cholesky decomp.</span></span>
<span id="cb697-15"><a href="supplemental.html#cb697-15"></a></span>
<span id="cb697-16"><a href="supplemental.html#cb697-16"></a><span class="va">xstar</span> <span class="op">=</span> <span class="va">linspace</span>(<span class="op">-</span><span class="fl">7.5</span><span class="op">,</span> <span class="fl">7.5</span><span class="op">,</span> <span class="fl">201</span>)<span class="op">&#39;;</span></span>
<span id="cb697-17"><a href="supplemental.html#cb697-17"></a></span>
<span id="cb697-18"><a href="supplemental.html#cb697-18"></a><span class="va">hyps</span> <span class="op">=</span> [<span class="va">log</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">log</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">log</span>(<span class="fl">0.1</span>)<span class="op">;...</span></span>
<span id="cb697-19"><a href="supplemental.html#cb697-19"></a>  <span class="va">log</span>(<span class="fl">0.3</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">1.08</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">0.00005</span>)<span class="op">;...</span></span>
<span id="cb697-20"><a href="supplemental.html#cb697-20"></a>  <span class="va">log</span>(<span class="fl">3</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">1.16</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">0.89</span>)]<span class="op">;</span></span>
<span id="cb697-21"><a href="supplemental.html#cb697-21"></a></span>
<span id="cb697-22"><a href="supplemental.html#cb697-22"></a><span class="co">%% compute post pred and plot marginals</span></span>
<span id="cb697-23"><a href="supplemental.html#cb697-23"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">size</span>(<span class="va">hyps</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb697-24"><a href="supplemental.html#cb697-24"></a>  <span class="va">loghyper</span> <span class="op">=</span> <span class="va">hyps</span>(<span class="va">i</span><span class="op">,:</span>)<span class="op">&#39;;</span></span>
<span id="cb697-25"><a href="supplemental.html#cb697-25"></a>  [<span class="va">mu</span><span class="op">,</span> <span class="va">S2</span>] <span class="op">=</span> <span class="va">gpr</span>(<span class="va">loghyper</span><span class="op">,</span> <span class="va">covfunc</span><span class="op">,</span> <span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">xstar</span>)<span class="op">;</span></span>
<span id="cb697-26"><a href="supplemental.html#cb697-26"></a>  <span class="va">S2</span> <span class="op">=</span> <span class="va">S2</span> <span class="op">-</span> <span class="va">exp</span>(<span class="fl">2</span><span class="op">*</span><span class="va">loghyper</span>(<span class="fl">3</span>))<span class="op">;</span> <span class="co">% remove observation noise</span></span>
<span id="cb697-27"><a href="supplemental.html#cb697-27"></a>  </span>
<span id="cb697-28"><a href="supplemental.html#cb697-28"></a>  <span class="va">figure</span><span class="op">;</span></span>
<span id="cb697-29"><a href="supplemental.html#cb697-29"></a>  <span class="va">f</span> <span class="op">=</span> [<span class="va">mu</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">;</span><span class="va">flipdim</span>(<span class="va">mu</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">,</span><span class="fl">1</span>)]<span class="op">;</span></span>
<span id="cb697-30"><a href="supplemental.html#cb697-30"></a>  <span class="va">fill</span>([<span class="va">xstar</span><span class="op">;</span> <span class="va">flipdim</span>(<span class="va">xstar</span><span class="op">,</span><span class="fl">1</span>)]<span class="op">,</span> <span class="va">f</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span><span class="op">,</span> <span class="ss">&#39;EdgeColor&#39;</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb697-31"><a href="supplemental.html#cb697-31"></a>  <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb697-32"><a href="supplemental.html#cb697-32"></a>  <span class="va">plot</span>(<span class="va">xstar</span><span class="op">,</span><span class="va">mu</span><span class="op">,</span><span class="ss">&#39;k-&#39;</span><span class="op">,</span><span class="ss">&#39;LineWidth&#39;</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb697-33"><a href="supplemental.html#cb697-33"></a>  <span class="va">plot</span>(<span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="ss">&#39;k+&#39;</span><span class="op">,</span> <span class="ss">&#39;MarkerSize&#39;</span><span class="op">,</span> <span class="fl">17</span>)<span class="op">;</span></span>
<span id="cb697-34"><a href="supplemental.html#cb697-34"></a>  <span class="va">axis</span>([<span class="op">-</span><span class="fl">8</span> <span class="fl">8</span> <span class="op">-</span><span class="fl">3</span> <span class="fl">3</span>])</span>
<span id="cb697-35"><a href="supplemental.html#cb697-35"></a>  <span class="va">printPmtkFigure</span>(<span class="va">sprintf</span>(<span class="ss">&#39;gprDemoChangeHparams%d&#39;</span><span class="op">,</span> <span class="va">i</span>))<span class="op">;</span></span>
<span id="cb697-36"><a href="supplemental.html#cb697-36"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb698"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb698-1"><a href="supplemental.html#cb698-1"></a><span class="co">%% Reproduce figure 2.2 from GP book</span></span>
<span id="cb698-2"><a href="supplemental.html#cb698-2"></a><span class="co">%</span></span>
<span id="cb698-3"><a href="supplemental.html#cb698-3"></a><span class="co">%%</span></span>
<span id="cb698-4"><a href="supplemental.html#cb698-4"></a></span>
<span id="cb698-5"><a href="supplemental.html#cb698-5"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb698-6"><a href="supplemental.html#cb698-6"></a></span>
<span id="cb698-7"><a href="supplemental.html#cb698-7"></a><span class="va">setSeed</span>(<span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb698-8"><a href="supplemental.html#cb698-8"></a><span class="va">L</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb698-9"><a href="supplemental.html#cb698-9"></a><span class="va">xs</span> <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="fl">0.2</span><span class="op">:</span><span class="fl">5</span>)<span class="op">&#39;;</span></span>
<span id="cb698-10"><a href="supplemental.html#cb698-10"></a><span class="va">ns</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">xs</span>)<span class="op">;</span></span>
<span id="cb698-11"><a href="supplemental.html#cb698-11"></a><span class="va">keps</span> <span class="op">=</span> <span class="fl">1e-8</span><span class="op">;</span></span>
<span id="cb698-12"><a href="supplemental.html#cb698-12"></a><span class="va">muFn</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="fl">0</span><span class="op">*</span><span class="va">x</span>(<span class="op">:</span>)<span class="op">.^</span><span class="fl">2</span><span class="op">;</span></span>
<span id="cb698-13"><a href="supplemental.html#cb698-13"></a><span class="va">Kfn</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">x</span><span class="op">,</span><span class="va">z</span>) <span class="fl">1</span><span class="op">*</span><span class="va">exp</span>(<span class="op">-</span><span class="va">sq_dist</span>(<span class="va">x</span><span class="op">&#39;/</span><span class="va">L</span><span class="op">,</span><span class="va">z</span><span class="op">&#39;/</span><span class="va">L</span>)<span class="op">/</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb698-14"><a href="supplemental.html#cb698-14"></a></span>
<span id="cb698-15"><a href="supplemental.html#cb698-15"></a></span>
<span id="cb698-16"><a href="supplemental.html#cb698-16"></a><span class="co">% plot sampled functions from the prior</span></span>
<span id="cb698-17"><a href="supplemental.html#cb698-17"></a><span class="va">figure</span><span class="op">;</span> <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb698-18"><a href="supplemental.html#cb698-18"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb698-19"><a href="supplemental.html#cb698-19"></a>  <span class="va">model</span> <span class="op">=</span> <span class="va">struct</span>(<span class="ss">&#39;mu&#39;</span><span class="op">,</span> <span class="va">muFn</span>(<span class="va">xs</span>)<span class="op">,</span> <span class="ss">&#39;Sigma&#39;</span><span class="op">,</span>  <span class="va">Kfn</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">xs</span>) <span class="op">+</span> <span class="fl">1e-15</span><span class="op">*</span><span class="va">eye</span>(<span class="va">size</span>(<span class="va">xs</span><span class="op">,</span> <span class="fl">1</span>)))<span class="op">;</span></span>
<span id="cb698-20"><a href="supplemental.html#cb698-20"></a>  <span class="va">fs</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">model</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb698-21"><a href="supplemental.html#cb698-21"></a>  <span class="va">plot</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">fs</span><span class="op">,</span> <span class="ss">&#39;k-&#39;</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">2</span>)</span>
<span id="cb698-22"><a href="supplemental.html#cb698-22"></a><span class="kw">end</span></span>
<span id="cb698-23"><a href="supplemental.html#cb698-23"></a><span class="va">printPmtkFigure</span>(<span class="ss">&#39;gprDemoNoiseFreePrior&#39;</span>)</span>
<span id="cb698-24"><a href="supplemental.html#cb698-24"></a></span>
<span id="cb698-25"><a href="supplemental.html#cb698-25"></a></span>
<span id="cb698-26"><a href="supplemental.html#cb698-26"></a><span class="co">% generate noise-less training data</span></span>
<span id="cb698-27"><a href="supplemental.html#cb698-27"></a><span class="va">Xtrain</span> <span class="op">=</span> [<span class="op">-</span><span class="fl">4</span><span class="op">,</span> <span class="op">-</span><span class="fl">3</span><span class="op">,</span> <span class="op">-</span><span class="fl">2</span><span class="op">,</span> <span class="op">-</span><span class="fl">1</span><span class="op">,</span> <span class="fl">1</span>]<span class="op">&#39;;</span></span>
<span id="cb698-28"><a href="supplemental.html#cb698-28"></a><span class="va">ftrain</span> <span class="op">=</span> <span class="va">sin</span>(<span class="va">Xtrain</span>)<span class="op">;</span></span>
<span id="cb698-29"><a href="supplemental.html#cb698-29"></a></span>
<span id="cb698-30"><a href="supplemental.html#cb698-30"></a><span class="co">% compute posterior predictive</span></span>
<span id="cb698-31"><a href="supplemental.html#cb698-31"></a><span class="va">K</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">Xtrain</span>)<span class="op">;</span> <span class="co">% K</span></span>
<span id="cb698-32"><a href="supplemental.html#cb698-32"></a><span class="va">Ks</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">xs</span>)<span class="op">;</span> <span class="co">%K_*</span></span>
<span id="cb698-33"><a href="supplemental.html#cb698-33"></a><span class="va">Kss</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">xs</span>) <span class="op">+</span> <span class="va">keps</span><span class="op">*</span><span class="va">eye</span>(<span class="va">length</span>(<span class="va">xs</span>))<span class="op">;</span> <span class="co">% K_** (keps is essential!)</span></span>
<span id="cb698-34"><a href="supplemental.html#cb698-34"></a><span class="va">Ki</span> <span class="op">=</span> <span class="va">inv</span>(<span class="va">K</span>)<span class="op">;</span></span>
<span id="cb698-35"><a href="supplemental.html#cb698-35"></a><span class="va">postMu</span> <span class="op">=</span> <span class="va">muFn</span>(<span class="va">xs</span>) <span class="op">+</span> <span class="va">Ks</span><span class="op">&#39;*</span><span class="va">Ki</span><span class="op">*</span>(<span class="va">ftrain</span> <span class="op">-</span> <span class="va">muFn</span>(<span class="va">Xtrain</span>))<span class="op">;</span></span>
<span id="cb698-36"><a href="supplemental.html#cb698-36"></a><span class="va">postCov</span> <span class="op">=</span> <span class="va">Kss</span> <span class="op">-</span> <span class="va">Ks</span><span class="op">&#39;*</span><span class="va">Ki</span><span class="op">*</span><span class="va">Ks</span><span class="op">;</span></span>
<span id="cb698-37"><a href="supplemental.html#cb698-37"></a></span>
<span id="cb698-38"><a href="supplemental.html#cb698-38"></a><span class="va">figure</span><span class="op">;</span> <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb698-39"><a href="supplemental.html#cb698-39"></a><span class="co">% plot marginal posterior variance as gray band</span></span>
<span id="cb698-40"><a href="supplemental.html#cb698-40"></a><span class="va">mu</span> <span class="op">=</span> <span class="va">postMu</span>(<span class="op">:</span>)<span class="op">;</span></span>
<span id="cb698-41"><a href="supplemental.html#cb698-41"></a><span class="va">S2</span> <span class="op">=</span> <span class="va">diag</span>(<span class="va">postCov</span>)<span class="op">;</span></span>
<span id="cb698-42"><a href="supplemental.html#cb698-42"></a><span class="va">f</span> <span class="op">=</span> [<span class="va">mu</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">;</span><span class="va">flipdim</span>(<span class="va">mu</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">,</span><span class="fl">1</span>)]<span class="op">;</span></span>
<span id="cb698-43"><a href="supplemental.html#cb698-43"></a><span class="va">fill</span>([<span class="va">xs</span><span class="op">;</span> <span class="va">flipdim</span>(<span class="va">xs</span><span class="op">,</span><span class="fl">1</span>)]<span class="op">,</span> <span class="va">f</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span><span class="op">,</span> <span class="ss">&#39;EdgeColor&#39;</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb698-44"><a href="supplemental.html#cb698-44"></a></span>
<span id="cb698-45"><a href="supplemental.html#cb698-45"></a><span class="co">% plot samples from posterior predictive</span></span>
<span id="cb698-46"><a href="supplemental.html#cb698-46"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb698-47"><a href="supplemental.html#cb698-47"></a>  <span class="va">model</span> <span class="op">=</span> <span class="va">struct</span>(<span class="ss">&#39;mu&#39;</span><span class="op">,</span> <span class="va">postMu</span>(<span class="op">:</span>)<span class="op">&#39;,</span> <span class="ss">&#39;Sigma&#39;</span><span class="op">,</span> <span class="va">postCov</span>)<span class="op">;</span></span>
<span id="cb698-48"><a href="supplemental.html#cb698-48"></a>  <span class="va">fs</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">model</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb698-49"><a href="supplemental.html#cb698-49"></a>  <span class="va">plot</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">fs</span><span class="op">,</span> <span class="ss">&#39;k-&#39;</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">2</span>)</span>
<span id="cb698-50"><a href="supplemental.html#cb698-50"></a>  <span class="va">h</span><span class="op">=</span><span class="va">plot</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">ftrain</span><span class="op">,</span> <span class="ss">&#39;kx&#39;</span><span class="op">,</span> <span class="ss">&#39;markersize&#39;</span><span class="op">,</span> <span class="fl">12</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">3</span>)<span class="op">;</span></span>
<span id="cb698-51"><a href="supplemental.html#cb698-51"></a><span class="kw">end</span></span>
<span id="cb698-52"><a href="supplemental.html#cb698-52"></a><span class="va">printPmtkFigure</span>(<span class="ss">&#39;gprDemoNoiseFreePost&#39;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="algorithms" class="section level2">
<h2>Algorithms</h2>
<div id="python" class="section level4">
<h4>Python</h4>
<div id="nelder-mead-1" class="section level5">
<h5>Nelder-Mead</h5>
</div>
<div id="hmm" class="section level5">
<h5>HMM</h5>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="em.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/supplemental.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
