<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Supplemental | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Supplemental | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Supplemental | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="em.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#create-the-weights"><i class="fa fa-check"></i>Create the Weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Chain Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#median-estimation"><i class="fa fa-check"></i>Median estimation</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gausian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-17"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-21"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-19"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-23"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-22"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayes-non-parametric.html"><a href="bayes-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayes-non-parametric.html"><a href="bayes-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayes-non-parametric.html"><a href="bayes-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Placeholder</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#bayesian-linear-regression"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#bayesian-mixed-model"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#estimation-21"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
</ul></li>
<li class="part"><span><b>Algorithms</b></span></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#functions-9"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-27"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#functions-10"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-11"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-3"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-function"><i class="fa fa-check"></i>Example Function</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful-eruptions"><i class="fa fa-check"></i>Example 1: Old Faithful eruptions</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris-data-set"><i class="fa fa-check"></i>Example 2: Iris data set</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-25"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-26"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supplemental" class="section level1">
<h1>Supplemental</h1>
<p><strong>IN PROGRESS</strong></p>
<div id="other-languages" class="section level2">
<h2>Other Languages</h2>
<p>When doing some of these models and algorithms, I had some other code to work with in another language, or, at the time, just wanted to try it in that language. There is not a whole lot here, but it still may be useful to some. Refer to the corresponding chapter of R code for context.</p>
<div id="python-demos" class="section level3">
<h3>Python Demos</h3>
<div id="linear-regression-1" class="section level4">
<h4>Linear Regression</h4>
<div id="data-setup-41" class="section level5">
<h5>Data Setup</h5>
<div class="sourceCode" id="cb703"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb703-1"><a href="supplemental.html#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb703-2"><a href="supplemental.html#cb703-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb703-3"><a href="supplemental.html#cb703-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb703-4"><a href="supplemental.html#cb703-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb703-5"><a href="supplemental.html#cb703-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-6"><a href="supplemental.html#cb703-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>) <span class="co"># ensures replication</span></span>
<span id="cb703-7"><a href="supplemental.html#cb703-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-8"><a href="supplemental.html#cb703-8" aria-hidden="true" tabindex="-1"></a><span class="co"># predictors and response</span></span>
<span id="cb703-9"><a href="supplemental.html#cb703-9" aria-hidden="true" tabindex="-1"></a><span class="co"># increasing N will get estimated values closer to the known parameters</span></span>
<span id="cb703-10"><a href="supplemental.html#cb703-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-11"><a href="supplemental.html#cb703-11" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span> <span class="co"># sample size</span></span>
<span id="cb703-12"><a href="supplemental.html#cb703-12" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span>   <span class="co"># number of desired predictors</span></span>
<span id="cb703-13"><a href="supplemental.html#cb703-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.matrix(np.random.normal(size <span class="op">=</span> N <span class="op">*</span> k)).reshape(N, k) </span>
<span id="cb703-14"><a href="supplemental.html#cb703-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span> <span class="op">+</span> <span class="fl">.2</span><span class="op">*</span>X[:, <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.1</span><span class="op">*</span>X[:, <span class="dv">1</span>] <span class="op">+</span> np.random.normal(scale <span class="op">=</span> <span class="fl">.5</span>, size <span class="op">=</span> N).reshape(N, <span class="dv">1</span>)  </span>
<span id="cb703-15"><a href="supplemental.html#cb703-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb703-16"><a href="supplemental.html#cb703-16" aria-hidden="true" tabindex="-1"></a>dfXy <span class="op">=</span> pd.DataFrame(np.column_stack([X, y]), columns <span class="op">=</span> [<span class="st">&#39;X1&#39;</span>, <span class="st">&#39;X2&#39;</span>, <span class="st">&#39;y&#39;</span>])</span></code></pre></div>
</div>
<div id="functions-12" class="section level5">
<h5>Functions</h5>
<p>A maximum likelihood approach.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb704-1"><a href="supplemental.html#cb704-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lm_ml(par, X, y):</span>
<span id="cb704-2"><a href="supplemental.html#cb704-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># par: parameters to be estimated</span></span>
<span id="cb704-3"><a href="supplemental.html#cb704-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: predictor matrix with intercept column</span></span>
<span id="cb704-4"><a href="supplemental.html#cb704-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: response</span></span>
<span id="cb704-5"><a href="supplemental.html#cb704-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb704-6"><a href="supplemental.html#cb704-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setup</span></span>
<span id="cb704-7"><a href="supplemental.html#cb704-7" aria-hidden="true" tabindex="-1"></a>  beta   <span class="op">=</span> par[<span class="dv">1</span>:].reshape(<span class="dv">3</span>, <span class="dv">1</span>)             <span class="co"># coefficients</span></span>
<span id="cb704-8"><a href="supplemental.html#cb704-8" aria-hidden="true" tabindex="-1"></a>  sigma  <span class="op">=</span> par[<span class="dv">0</span>]                            <span class="co"># error sd</span></span>
<span id="cb704-9"><a href="supplemental.html#cb704-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N = X.shape[0]</span></span>
<span id="cb704-10"><a href="supplemental.html#cb704-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb704-11"><a href="supplemental.html#cb704-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb704-12"><a href="supplemental.html#cb704-12" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> X <span class="op">*</span> beta                              <span class="co"># linear predictor</span></span>
<span id="cb704-13"><a href="supplemental.html#cb704-13" aria-hidden="true" tabindex="-1"></a>  mu <span class="op">=</span> LP                                    <span class="co"># identity link in the glm sense</span></span>
<span id="cb704-14"><a href="supplemental.html#cb704-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb704-15"><a href="supplemental.html#cb704-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate likelihood</span></span>
<span id="cb704-16"><a href="supplemental.html#cb704-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb704-17"><a href="supplemental.html#cb704-17" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> norm.pdf(y, loc <span class="op">=</span> mu, scale <span class="op">=</span> sigma) <span class="co"># log likelihood</span></span>
<span id="cb704-18"><a href="supplemental.html#cb704-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb704-19"><a href="supplemental.html#cb704-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># L =  -.5*N*log(sigma2) - .5*(1/sigma2)*crossprod(y-mu)    # alternate log likelihood form</span></span>
<span id="cb704-20"><a href="supplemental.html#cb704-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb704-21"><a href="supplemental.html#cb704-21" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(np.log(L))       <span class="co"># optim by default is minimization, and we want to maximize the likelihood </span></span>
<span id="cb704-22"><a href="supplemental.html#cb704-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb704-23"><a href="supplemental.html#cb704-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(L)</span></code></pre></div>
<p>An approach via least squares loss function.</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb705-1"><a href="supplemental.html#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lm_ls(par, X, y):</span>
<span id="cb705-2"><a href="supplemental.html#cb705-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># par: parameters to be estimated</span></span>
<span id="cb705-3"><a href="supplemental.html#cb705-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: predictor matrix with intercept column</span></span>
<span id="cb705-4"><a href="supplemental.html#cb705-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: response</span></span>
<span id="cb705-5"><a href="supplemental.html#cb705-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb705-6"><a href="supplemental.html#cb705-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setup</span></span>
<span id="cb705-7"><a href="supplemental.html#cb705-7" aria-hidden="true" tabindex="-1"></a>  beta <span class="op">=</span> par.reshape(<span class="dv">3</span>, <span class="dv">1</span>)              <span class="co"># coefficients</span></span>
<span id="cb705-8"><a href="supplemental.html#cb705-8" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb705-9"><a href="supplemental.html#cb705-9" aria-hidden="true" tabindex="-1"></a>  p <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb705-10"><a href="supplemental.html#cb705-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb705-11"><a href="supplemental.html#cb705-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb705-12"><a href="supplemental.html#cb705-12" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> X <span class="op">*</span> beta                              <span class="co"># linear predictor</span></span>
<span id="cb705-13"><a href="supplemental.html#cb705-13" aria-hidden="true" tabindex="-1"></a>  mu <span class="op">=</span> LP                                    <span class="co"># identity link in the glm sense</span></span>
<span id="cb705-14"><a href="supplemental.html#cb705-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb705-15"><a href="supplemental.html#cb705-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # squared error loss</span></span>
<span id="cb705-16"><a href="supplemental.html#cb705-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb705-17"><a href="supplemental.html#cb705-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(np.<span class="bu">sum</span>(np.square(y <span class="op">-</span> mu)))</span></code></pre></div>
</div>
<div id="estimation-37" class="section level5">
<h5>Estimation</h5>
<div class="sourceCode" id="cb706"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb706-1"><a href="supplemental.html#cb706-1" aria-hidden="true" tabindex="-1"></a>X_mm <span class="op">=</span> np.column_stack([np.repeat(<span class="dv">1</span>, N).reshape(N, <span class="dv">1</span>), X])</span>
<span id="cb706-2"><a href="supplemental.html#cb706-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-3"><a href="supplemental.html#cb706-3" aria-hidden="true" tabindex="-1"></a><span class="co"># you may get warnings, they can be ignored</span></span>
<span id="cb706-4"><a href="supplemental.html#cb706-4" aria-hidden="true" tabindex="-1"></a>result_ml <span class="op">=</span> minimize(</span>
<span id="cb706-5"><a href="supplemental.html#cb706-5" aria-hidden="true" tabindex="-1"></a>  fun <span class="op">=</span> lm_ml,</span>
<span id="cb706-6"><a href="supplemental.html#cb706-6" aria-hidden="true" tabindex="-1"></a>  x0  <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb706-7"><a href="supplemental.html#cb706-7" aria-hidden="true" tabindex="-1"></a>  args    <span class="op">=</span> (X_mm, y),</span>
<span id="cb706-8"><a href="supplemental.html#cb706-8" aria-hidden="true" tabindex="-1"></a>  bounds  <span class="op">=</span> ((<span class="dv">0</span>, <span class="va">None</span>), (<span class="va">None</span>, <span class="va">None</span>), (<span class="va">None</span>, <span class="va">None</span>), (<span class="va">None</span>, <span class="va">None</span>)),</span>
<span id="cb706-9"><a href="supplemental.html#cb706-9" aria-hidden="true" tabindex="-1"></a>  method  <span class="op">=</span> <span class="st">&#39;L-BFGS-B&#39;</span>, </span>
<span id="cb706-10"><a href="supplemental.html#cb706-10" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb706-11"><a href="supplemental.html#cb706-11" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb706-12"><a href="supplemental.html#cb706-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb706-13"><a href="supplemental.html#cb706-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-14"><a href="supplemental.html#cb706-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-15"><a href="supplemental.html#cb706-15" aria-hidden="true" tabindex="-1"></a><span class="co"># can use least_squares directly</span></span>
<span id="cb706-16"><a href="supplemental.html#cb706-16" aria-hidden="true" tabindex="-1"></a><span class="co"># from scipy.optimize import least_squares</span></span>
<span id="cb706-17"><a href="supplemental.html#cb706-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb706-18"><a href="supplemental.html#cb706-18" aria-hidden="true" tabindex="-1"></a>result_ls <span class="op">=</span> minimize(</span>
<span id="cb706-19"><a href="supplemental.html#cb706-19" aria-hidden="true" tabindex="-1"></a>  lm_ls,</span>
<span id="cb706-20"><a href="supplemental.html#cb706-20" aria-hidden="true" tabindex="-1"></a>  x0   <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb706-21"><a href="supplemental.html#cb706-21" aria-hidden="true" tabindex="-1"></a>  args <span class="op">=</span> (X_mm, y), </span>
<span id="cb706-22"><a href="supplemental.html#cb706-22" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb706-23"><a href="supplemental.html#cb706-23" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb706-24"><a href="supplemental.html#cb706-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="comparison-43" class="section level5">
<h5>Comparison</h5>
<div class="sourceCode" id="cb707"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb707-1"><a href="supplemental.html#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb707-2"><a href="supplemental.html#cb707-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-3"><a href="supplemental.html#cb707-3" aria-hidden="true" tabindex="-1"></a>model_sm_ols  <span class="op">=</span> smf.ols(<span class="st">&#39;y ~ X1 + X2&#39;</span>, data <span class="op">=</span> dfXy)</span>
<span id="cb707-4"><a href="supplemental.html#cb707-4" aria-hidden="true" tabindex="-1"></a>result_sm_ols <span class="op">=</span> model.fit()</span>
<span id="cb707-5"><a href="supplemental.html#cb707-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-6"><a href="supplemental.html#cb707-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(</span>
<span id="cb707-7"><a href="supplemental.html#cb707-7" aria-hidden="true" tabindex="-1"></a>  [</span>
<span id="cb707-8"><a href="supplemental.html#cb707-8" aria-hidden="true" tabindex="-1"></a>  np.append(result_ml.x[<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span>, result_ml.x[<span class="dv">1</span>:]), </span>
<span id="cb707-9"><a href="supplemental.html#cb707-9" aria-hidden="true" tabindex="-1"></a>  np.append(result_ls.fun<span class="op">/</span>(N <span class="op">-</span> X_mm.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>), result_ls.x), </span>
<span id="cb707-10"><a href="supplemental.html#cb707-10" aria-hidden="true" tabindex="-1"></a>  np.append(result_sm_ols.scale, result_sm_ols.params)</span>
<span id="cb707-11"><a href="supplemental.html#cb707-11" aria-hidden="true" tabindex="-1"></a>  ], </span>
<span id="cb707-12"><a href="supplemental.html#cb707-12" aria-hidden="true" tabindex="-1"></a>  columns <span class="op">=</span> [<span class="st">&#39;sigma&#39;</span>,<span class="st">&#39;Int&#39;</span>, <span class="st">&#39;b_X1&#39;</span>, <span class="st">&#39;b_X2&#39;</span>], </span>
<span id="cb707-13"><a href="supplemental.html#cb707-13" aria-hidden="true" tabindex="-1"></a>  index   <span class="op">=</span> [<span class="st">&#39;ML&#39;</span>, <span class="st">&#39;OLS&#39;</span>, <span class="st">&#39;SM&#39;</span>]</span>
<span id="cb707-14"><a href="supplemental.html#cb707-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>
        sigma       Int      b_X1    b_X2
ML   0.240332 -0.494647  0.213036  0.0815
OLS  0.241297 -0.494647  0.213036  0.0815
SM   0.241055 -0.494647  0.213036  0.0815    
    </code></pre>
</div>
</div>
<div id="nelder-mead-1" class="section level4">
<h4>Nelder-Mead</h4>
<div class="sourceCode" id="cb709"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb709-1"><a href="supplemental.html#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb709-2"><a href="supplemental.html#cb709-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-3"><a href="supplemental.html#cb709-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb709-4"><a href="supplemental.html#cb709-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Francois Chollet&#39;s Nelder-Mead in Python.</span></span>
<span id="cb709-5"><a href="supplemental.html#cb709-5" aria-hidden="true" tabindex="-1"></a><span class="co">    https://github.com/fchollet/nelder-mead/blob/master/nelder_mead.py</span></span>
<span id="cb709-6"><a href="supplemental.html#cb709-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Pure Python/Numpy implementation of the Nelder-Mead algorithm.</span></span>
<span id="cb709-7"><a href="supplemental.html#cb709-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Reference: https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</span></span>
<span id="cb709-8"><a href="supplemental.html#cb709-8" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb709-9"><a href="supplemental.html#cb709-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-10"><a href="supplemental.html#cb709-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-11"><a href="supplemental.html#cb709-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nelder_mead(</span>
<span id="cb709-12"><a href="supplemental.html#cb709-12" aria-hidden="true" tabindex="-1"></a>  f,</span>
<span id="cb709-13"><a href="supplemental.html#cb709-13" aria-hidden="true" tabindex="-1"></a>  x_start,</span>
<span id="cb709-14"><a href="supplemental.html#cb709-14" aria-hidden="true" tabindex="-1"></a>  step <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb709-15"><a href="supplemental.html#cb709-15" aria-hidden="true" tabindex="-1"></a>  no_improve_thr  <span class="op">=</span> <span class="fl">10e-6</span>,</span>
<span id="cb709-16"><a href="supplemental.html#cb709-16" aria-hidden="true" tabindex="-1"></a>  no_improv_break <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb709-17"><a href="supplemental.html#cb709-17" aria-hidden="true" tabindex="-1"></a>  max_iter <span class="op">=</span> <span class="dv">0</span>,</span>
<span id="cb709-18"><a href="supplemental.html#cb709-18" aria-hidden="true" tabindex="-1"></a>  alpha <span class="op">=</span> <span class="fl">1.</span>,</span>
<span id="cb709-19"><a href="supplemental.html#cb709-19" aria-hidden="true" tabindex="-1"></a>  gamma <span class="op">=</span> <span class="fl">2.</span>,</span>
<span id="cb709-20"><a href="supplemental.html#cb709-20" aria-hidden="true" tabindex="-1"></a>  rho   <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb709-21"><a href="supplemental.html#cb709-21" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb709-22"><a href="supplemental.html#cb709-22" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb709-23"><a href="supplemental.html#cb709-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb709-24"><a href="supplemental.html#cb709-24" aria-hidden="true" tabindex="-1"></a><span class="co">        @param f (function): function to optimize, must return a scalar score</span></span>
<span id="cb709-25"><a href="supplemental.html#cb709-25" aria-hidden="true" tabindex="-1"></a><span class="co">            and operate over a numpy array of the same dimensions as x_start</span></span>
<span id="cb709-26"><a href="supplemental.html#cb709-26" aria-hidden="true" tabindex="-1"></a><span class="co">        @param x_start (numpy array): initial position</span></span>
<span id="cb709-27"><a href="supplemental.html#cb709-27" aria-hidden="true" tabindex="-1"></a><span class="co">        @param step (float): look-around radius in initial step</span></span>
<span id="cb709-28"><a href="supplemental.html#cb709-28" aria-hidden="true" tabindex="-1"></a><span class="co">        @no_improv_thr,  no_improv_break (float, int): break after no_improv_break iterations with</span></span>
<span id="cb709-29"><a href="supplemental.html#cb709-29" aria-hidden="true" tabindex="-1"></a><span class="co">            an improvement lower than no_improv_thr</span></span>
<span id="cb709-30"><a href="supplemental.html#cb709-30" aria-hidden="true" tabindex="-1"></a><span class="co">        @max_iter (int): always break after this number of iterations.</span></span>
<span id="cb709-31"><a href="supplemental.html#cb709-31" aria-hidden="true" tabindex="-1"></a><span class="co">            Set it to 0 to loop indefinitely.</span></span>
<span id="cb709-32"><a href="supplemental.html#cb709-32" aria-hidden="true" tabindex="-1"></a><span class="co">        @alpha, gamma, rho, sigma (floats): parameters of the algorithm</span></span>
<span id="cb709-33"><a href="supplemental.html#cb709-33" aria-hidden="true" tabindex="-1"></a><span class="co">            (see Wikipedia page for reference)</span></span>
<span id="cb709-34"><a href="supplemental.html#cb709-34" aria-hidden="true" tabindex="-1"></a><span class="co">        return: tuple (best parameter array, best score)</span></span>
<span id="cb709-35"><a href="supplemental.html#cb709-35" aria-hidden="true" tabindex="-1"></a><span class="co">    &#39;&#39;&#39;</span></span>
<span id="cb709-36"><a href="supplemental.html#cb709-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-37"><a href="supplemental.html#cb709-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># init</span></span>
<span id="cb709-38"><a href="supplemental.html#cb709-38" aria-hidden="true" tabindex="-1"></a>    dim <span class="op">=</span> <span class="bu">len</span>(x_start)</span>
<span id="cb709-39"><a href="supplemental.html#cb709-39" aria-hidden="true" tabindex="-1"></a>    prev_best <span class="op">=</span> f(x_start)</span>
<span id="cb709-40"><a href="supplemental.html#cb709-40" aria-hidden="true" tabindex="-1"></a>    no_improv <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb709-41"><a href="supplemental.html#cb709-41" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> [[x_start, prev_best]]</span>
<span id="cb709-42"><a href="supplemental.html#cb709-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-43"><a href="supplemental.html#cb709-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(dim):</span>
<span id="cb709-44"><a href="supplemental.html#cb709-44" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> copy.copy(x_start)</span>
<span id="cb709-45"><a href="supplemental.html#cb709-45" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="op">=</span> x[i] <span class="op">+</span> step</span>
<span id="cb709-46"><a href="supplemental.html#cb709-46" aria-hidden="true" tabindex="-1"></a>        score <span class="op">=</span> f(x)</span>
<span id="cb709-47"><a href="supplemental.html#cb709-47" aria-hidden="true" tabindex="-1"></a>        res.append([x, score])</span>
<span id="cb709-48"><a href="supplemental.html#cb709-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-49"><a href="supplemental.html#cb709-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simplex iter</span></span>
<span id="cb709-50"><a href="supplemental.html#cb709-50" aria-hidden="true" tabindex="-1"></a>    iters <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb709-51"><a href="supplemental.html#cb709-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="dv">1</span>:</span>
<span id="cb709-52"><a href="supplemental.html#cb709-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># order</span></span>
<span id="cb709-53"><a href="supplemental.html#cb709-53" aria-hidden="true" tabindex="-1"></a>        res.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb709-54"><a href="supplemental.html#cb709-54" aria-hidden="true" tabindex="-1"></a>        best <span class="op">=</span> res[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb709-55"><a href="supplemental.html#cb709-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-56"><a href="supplemental.html#cb709-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># break after max_iter</span></span>
<span id="cb709-57"><a href="supplemental.html#cb709-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_iter <span class="kw">and</span> iters <span class="op">&gt;=</span> max_iter:</span>
<span id="cb709-58"><a href="supplemental.html#cb709-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> res[<span class="dv">0</span>]</span>
<span id="cb709-59"><a href="supplemental.html#cb709-59" aria-hidden="true" tabindex="-1"></a>        iters <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb709-60"><a href="supplemental.html#cb709-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-61"><a href="supplemental.html#cb709-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># break after no_improv_break iterations with no improvement</span></span>
<span id="cb709-62"><a href="supplemental.html#cb709-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iters<span class="op">//</span><span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb709-63"><a href="supplemental.html#cb709-63" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(<span class="st">&#39;...best so far:&#39;</span>, best)</span>
<span id="cb709-64"><a href="supplemental.html#cb709-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-65"><a href="supplemental.html#cb709-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> best <span class="op">&lt;</span> prev_best <span class="op">-</span> no_improve_thr:</span>
<span id="cb709-66"><a href="supplemental.html#cb709-66" aria-hidden="true" tabindex="-1"></a>            no_improv <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb709-67"><a href="supplemental.html#cb709-67" aria-hidden="true" tabindex="-1"></a>            prev_best <span class="op">=</span> best</span>
<span id="cb709-68"><a href="supplemental.html#cb709-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb709-69"><a href="supplemental.html#cb709-69" aria-hidden="true" tabindex="-1"></a>            no_improv <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb709-70"><a href="supplemental.html#cb709-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-71"><a href="supplemental.html#cb709-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> no_improv <span class="op">&gt;=</span> no_improv_break:</span>
<span id="cb709-72"><a href="supplemental.html#cb709-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> res[<span class="dv">0</span>]</span>
<span id="cb709-73"><a href="supplemental.html#cb709-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-74"><a href="supplemental.html#cb709-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># centroid</span></span>
<span id="cb709-75"><a href="supplemental.html#cb709-75" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> [<span class="fl">0.</span>] <span class="op">*</span> dim</span>
<span id="cb709-76"><a href="supplemental.html#cb709-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tup <span class="kw">in</span> res[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb709-77"><a href="supplemental.html#cb709-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(tup[<span class="dv">0</span>]):</span>
<span id="cb709-78"><a href="supplemental.html#cb709-78" aria-hidden="true" tabindex="-1"></a>                x0[i] <span class="op">+=</span> c <span class="op">/</span> (<span class="bu">len</span>(res)<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb709-79"><a href="supplemental.html#cb709-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-80"><a href="supplemental.html#cb709-80" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reflection</span></span>
<span id="cb709-81"><a href="supplemental.html#cb709-81" aria-hidden="true" tabindex="-1"></a>        xr <span class="op">=</span> x0 <span class="op">+</span> alpha<span class="op">*</span>(x0 <span class="op">-</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb709-82"><a href="supplemental.html#cb709-82" aria-hidden="true" tabindex="-1"></a>        rscore <span class="op">=</span> f(xr)</span>
<span id="cb709-83"><a href="supplemental.html#cb709-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> res[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">&lt;=</span> rscore <span class="op">&lt;</span> res[<span class="op">-</span><span class="dv">2</span>][<span class="dv">1</span>]:</span>
<span id="cb709-84"><a href="supplemental.html#cb709-84" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb709-85"><a href="supplemental.html#cb709-85" aria-hidden="true" tabindex="-1"></a>            res.append([xr, rscore])</span>
<span id="cb709-86"><a href="supplemental.html#cb709-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb709-87"><a href="supplemental.html#cb709-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-88"><a href="supplemental.html#cb709-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># expansion</span></span>
<span id="cb709-89"><a href="supplemental.html#cb709-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rscore <span class="op">&lt;</span> res[<span class="dv">0</span>][<span class="dv">1</span>]:</span>
<span id="cb709-90"><a href="supplemental.html#cb709-90" aria-hidden="true" tabindex="-1"></a>            xe <span class="op">=</span> x0 <span class="op">+</span> gamma<span class="op">*</span>(x0 <span class="op">-</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb709-91"><a href="supplemental.html#cb709-91" aria-hidden="true" tabindex="-1"></a>            escore <span class="op">=</span> f(xe)</span>
<span id="cb709-92"><a href="supplemental.html#cb709-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> escore <span class="op">&lt;</span> rscore:</span>
<span id="cb709-93"><a href="supplemental.html#cb709-93" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb709-94"><a href="supplemental.html#cb709-94" aria-hidden="true" tabindex="-1"></a>                res.append([xe, escore])</span>
<span id="cb709-95"><a href="supplemental.html#cb709-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb709-96"><a href="supplemental.html#cb709-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb709-97"><a href="supplemental.html#cb709-97" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb709-98"><a href="supplemental.html#cb709-98" aria-hidden="true" tabindex="-1"></a>                res.append([xr, rscore])</span>
<span id="cb709-99"><a href="supplemental.html#cb709-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb709-100"><a href="supplemental.html#cb709-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-101"><a href="supplemental.html#cb709-101" aria-hidden="true" tabindex="-1"></a>        <span class="co"># contraction</span></span>
<span id="cb709-102"><a href="supplemental.html#cb709-102" aria-hidden="true" tabindex="-1"></a>        xc <span class="op">=</span> x0 <span class="op">+</span> rho<span class="op">*</span>(x0 <span class="op">-</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb709-103"><a href="supplemental.html#cb709-103" aria-hidden="true" tabindex="-1"></a>        cscore <span class="op">=</span> f(xc)</span>
<span id="cb709-104"><a href="supplemental.html#cb709-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cscore <span class="op">&lt;</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]:</span>
<span id="cb709-105"><a href="supplemental.html#cb709-105" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb709-106"><a href="supplemental.html#cb709-106" aria-hidden="true" tabindex="-1"></a>            res.append([xc, cscore])</span>
<span id="cb709-107"><a href="supplemental.html#cb709-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb709-108"><a href="supplemental.html#cb709-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-109"><a href="supplemental.html#cb709-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduction</span></span>
<span id="cb709-110"><a href="supplemental.html#cb709-110" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> res[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb709-111"><a href="supplemental.html#cb709-111" aria-hidden="true" tabindex="-1"></a>        nres <span class="op">=</span> []</span>
<span id="cb709-112"><a href="supplemental.html#cb709-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tup <span class="kw">in</span> res:</span>
<span id="cb709-113"><a href="supplemental.html#cb709-113" aria-hidden="true" tabindex="-1"></a>            redx <span class="op">=</span> x1 <span class="op">+</span> sigma<span class="op">*</span>(tup[<span class="dv">0</span>] <span class="op">-</span> x1)</span>
<span id="cb709-114"><a href="supplemental.html#cb709-114" aria-hidden="true" tabindex="-1"></a>            score <span class="op">=</span> f(redx)</span>
<span id="cb709-115"><a href="supplemental.html#cb709-115" aria-hidden="true" tabindex="-1"></a>            nres.append([redx, score])</span>
<span id="cb709-116"><a href="supplemental.html#cb709-116" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> nres</span>
<span id="cb709-117"><a href="supplemental.html#cb709-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-118"><a href="supplemental.html#cb709-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-119"><a href="supplemental.html#cb709-119" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb709-120"><a href="supplemental.html#cb709-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># test</span></span>
<span id="cb709-121"><a href="supplemental.html#cb709-121" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> math</span>
<span id="cb709-122"><a href="supplemental.html#cb709-122" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb709-123"><a href="supplemental.html#cb709-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-124"><a href="supplemental.html#cb709-124" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> f(x):</span>
<span id="cb709-125"><a href="supplemental.html#cb709-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> math.sin(x[<span class="dv">0</span>]) <span class="op">*</span> math.cos(x[<span class="dv">1</span>]) <span class="op">*</span> (<span class="fl">1.</span> <span class="op">/</span> (<span class="bu">abs</span>(x[<span class="dv">2</span>]) <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb709-126"><a href="supplemental.html#cb709-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-127"><a href="supplemental.html#cb709-127" aria-hidden="true" tabindex="-1"></a>nelder_mead(f, np.array([<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>]))</span></code></pre></div>
</div>
<div id="hmm" class="section level4">
<h4>HMM</h4>
<div class="sourceCode" id="cb710"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb710-1"><a href="supplemental.html#cb710-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb710-2"><a href="supplemental.html#cb710-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -*- coding: utf-8 -*-</span></span>
<span id="cb710-3"><a href="supplemental.html#cb710-3" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb710-4"><a href="supplemental.html#cb710-4" aria-hidden="true" tabindex="-1"></a><span class="co">From the wikipedia page with slight modification</span></span>
<span id="cb710-5"><a href="supplemental.html#cb710-5" aria-hidden="true" tabindex="-1"></a><span class="co">https://en.wikipedia.org/wiki/Viterbi_algorithm#Example</span></span>
<span id="cb710-6"><a href="supplemental.html#cb710-6" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb710-7"><a href="supplemental.html#cb710-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-8"><a href="supplemental.html#cb710-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(obs, states, start_p, trans_p, emit_p):</span>
<span id="cb710-9"><a href="supplemental.html#cb710-9" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> [{}]</span>
<span id="cb710-10"><a href="supplemental.html#cb710-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-11"><a href="supplemental.html#cb710-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> st <span class="kw">in</span> states:</span>
<span id="cb710-12"><a href="supplemental.html#cb710-12" aria-hidden="true" tabindex="-1"></a>        V[<span class="dv">0</span>][st] <span class="op">=</span> {<span class="st">&quot;prob&quot;</span>: start_p[st] <span class="op">*</span> emit_p[st][obs[<span class="dv">0</span>]], <span class="st">&quot;prev&quot;</span>: <span class="va">None</span>}</span>
<span id="cb710-13"><a href="supplemental.html#cb710-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-14"><a href="supplemental.html#cb710-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run Viterbi when t &gt; 0</span></span>
<span id="cb710-15"><a href="supplemental.html#cb710-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-16"><a href="supplemental.html#cb710-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(obs)):</span>
<span id="cb710-17"><a href="supplemental.html#cb710-17" aria-hidden="true" tabindex="-1"></a>        V.append({})</span>
<span id="cb710-18"><a href="supplemental.html#cb710-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-19"><a href="supplemental.html#cb710-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> st <span class="kw">in</span> states:</span>
<span id="cb710-20"><a href="supplemental.html#cb710-20" aria-hidden="true" tabindex="-1"></a>            max_tr_prob <span class="op">=</span> <span class="bu">max</span>(V[t<span class="op">-</span><span class="dv">1</span>][prev_st][<span class="st">&quot;prob&quot;</span>]<span class="op">*</span>trans_p[prev_st][st] <span class="cf">for</span> prev_st <span class="kw">in</span> states)</span>
<span id="cb710-21"><a href="supplemental.html#cb710-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-22"><a href="supplemental.html#cb710-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> prev_st <span class="kw">in</span> states:</span>
<span id="cb710-23"><a href="supplemental.html#cb710-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> V[t<span class="op">-</span><span class="dv">1</span>][prev_st][<span class="st">&quot;prob&quot;</span>] <span class="op">*</span> trans_p[prev_st][st] <span class="op">==</span> max_tr_prob:</span>
<span id="cb710-24"><a href="supplemental.html#cb710-24" aria-hidden="true" tabindex="-1"></a>                    max_prob <span class="op">=</span> max_tr_prob <span class="op">*</span> emit_p[st][obs[t]]</span>
<span id="cb710-25"><a href="supplemental.html#cb710-25" aria-hidden="true" tabindex="-1"></a>                    V[t][st] <span class="op">=</span> {<span class="st">&quot;prob&quot;</span>: max_prob, <span class="st">&quot;prev&quot;</span>: prev_st}</span>
<span id="cb710-26"><a href="supplemental.html#cb710-26" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb710-27"><a href="supplemental.html#cb710-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-28"><a href="supplemental.html#cb710-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> dptable(V):</span>
<span id="cb710-29"><a href="supplemental.html#cb710-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(line)</span>
<span id="cb710-30"><a href="supplemental.html#cb710-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-31"><a href="supplemental.html#cb710-31" aria-hidden="true" tabindex="-1"></a>    opt <span class="op">=</span> []</span>
<span id="cb710-32"><a href="supplemental.html#cb710-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-33"><a href="supplemental.html#cb710-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The highest probability</span></span>
<span id="cb710-34"><a href="supplemental.html#cb710-34" aria-hidden="true" tabindex="-1"></a>    max_prob <span class="op">=</span> <span class="bu">max</span>(value[<span class="st">&quot;prob&quot;</span>] <span class="cf">for</span> value <span class="kw">in</span> V[<span class="op">-</span><span class="dv">1</span>].values())</span>
<span id="cb710-35"><a href="supplemental.html#cb710-35" aria-hidden="true" tabindex="-1"></a>    previous <span class="op">=</span> <span class="va">None</span></span>
<span id="cb710-36"><a href="supplemental.html#cb710-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-37"><a href="supplemental.html#cb710-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get most probable state and its backtrack</span></span>
<span id="cb710-38"><a href="supplemental.html#cb710-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> st, data <span class="kw">in</span> V[<span class="op">-</span><span class="dv">1</span>].items():</span>
<span id="cb710-39"><a href="supplemental.html#cb710-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data[<span class="st">&quot;prob&quot;</span>] <span class="op">==</span> max_prob:</span>
<span id="cb710-40"><a href="supplemental.html#cb710-40" aria-hidden="true" tabindex="-1"></a>            opt.append(st)</span>
<span id="cb710-41"><a href="supplemental.html#cb710-41" aria-hidden="true" tabindex="-1"></a>            previous <span class="op">=</span> st</span>
<span id="cb710-42"><a href="supplemental.html#cb710-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb710-43"><a href="supplemental.html#cb710-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-44"><a href="supplemental.html#cb710-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Follow the backtrack till the first observation</span></span>
<span id="cb710-45"><a href="supplemental.html#cb710-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(V) <span class="op">-</span> <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb710-46"><a href="supplemental.html#cb710-46" aria-hidden="true" tabindex="-1"></a>        opt.insert(<span class="dv">0</span>, V[t <span class="op">+</span> <span class="dv">1</span>][previous][<span class="st">&quot;prev&quot;</span>])</span>
<span id="cb710-47"><a href="supplemental.html#cb710-47" aria-hidden="true" tabindex="-1"></a>        previous <span class="op">=</span> V[t <span class="op">+</span> <span class="dv">1</span>][previous][<span class="st">&quot;prev&quot;</span>]</span>
<span id="cb710-48"><a href="supplemental.html#cb710-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-49"><a href="supplemental.html#cb710-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;The steps of states are &#39;</span> <span class="op">+</span> <span class="st">&#39; &#39;</span>.join(opt) <span class="op">+</span> <span class="st">&#39; with highest probability of </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> max_prob)</span>
<span id="cb710-50"><a href="supplemental.html#cb710-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-51"><a href="supplemental.html#cb710-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-52"><a href="supplemental.html#cb710-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dptable(V):</span>
<span id="cb710-53"><a href="supplemental.html#cb710-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print a table of steps from dictionary</span></span>
<span id="cb710-54"><a href="supplemental.html#cb710-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="st">&quot; &quot;</span>.join((<span class="st">&quot;</span><span class="sc">%12d</span><span class="st">&quot;</span> <span class="op">%</span> i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(V)))</span>
<span id="cb710-55"><a href="supplemental.html#cb710-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb710-56"><a href="supplemental.html#cb710-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state <span class="kw">in</span> V[<span class="dv">0</span>]:</span>
<span id="cb710-57"><a href="supplemental.html#cb710-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="st">&quot;</span><span class="sc">%.7s</span><span class="st">: &quot;</span> <span class="op">%</span> state <span class="op">+</span> <span class="st">&quot; &quot;</span>.join(<span class="st">&quot;</span><span class="sc">%.7s</span><span class="st">&quot;</span> <span class="op">%</span> (<span class="st">&quot;</span><span class="sc">%f</span><span class="st">&quot;</span> <span class="op">%</span> v[state][<span class="st">&quot;prob&quot;</span>]) <span class="cf">for</span> v <span class="kw">in</span> V)</span>
<span id="cb710-58"><a href="supplemental.html#cb710-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-59"><a href="supplemental.html#cb710-59" aria-hidden="true" tabindex="-1"></a><span class="co"># The function viterbi takes the following arguments: obs is the sequence of</span></span>
<span id="cb710-60"><a href="supplemental.html#cb710-60" aria-hidden="true" tabindex="-1"></a><span class="co"># observations, e.g. [&#39;normal&#39;, &#39;cold&#39;, &#39;dizzy&#39;]; states is the set of hidden</span></span>
<span id="cb710-61"><a href="supplemental.html#cb710-61" aria-hidden="true" tabindex="-1"></a><span class="co"># states; start_p is the start probability; trans_p are the transition</span></span>
<span id="cb710-62"><a href="supplemental.html#cb710-62" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities; and emit_p are the emission probabilities. For simplicity of</span></span>
<span id="cb710-63"><a href="supplemental.html#cb710-63" aria-hidden="true" tabindex="-1"></a><span class="co"># code, we assume that the observation sequence obs is non-empty and that</span></span>
<span id="cb710-64"><a href="supplemental.html#cb710-64" aria-hidden="true" tabindex="-1"></a><span class="co"># trans_p[i][j] and emit_p[i][j] is defined for all states i,j.</span></span>
<span id="cb710-65"><a href="supplemental.html#cb710-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-66"><a href="supplemental.html#cb710-66" aria-hidden="true" tabindex="-1"></a><span class="co"># In the running example, the forward/Viterbi algorithm is used as follows:</span></span>
<span id="cb710-67"><a href="supplemental.html#cb710-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-68"><a href="supplemental.html#cb710-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-69"><a href="supplemental.html#cb710-69" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="st">&#39;normal&#39;</span>, <span class="st">&#39;cold&#39;</span>, <span class="st">&#39;dizzy&#39;</span>)</span>
<span id="cb710-70"><a href="supplemental.html#cb710-70" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> (<span class="st">&#39;Healthy&#39;</span>, <span class="st">&#39;Fever&#39;</span>)</span>
<span id="cb710-71"><a href="supplemental.html#cb710-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-72"><a href="supplemental.html#cb710-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-73"><a href="supplemental.html#cb710-73" aria-hidden="true" tabindex="-1"></a>start_p <span class="op">=</span> {<span class="st">&#39;Healthy&#39;</span>: <span class="fl">0.6</span>, <span class="st">&#39;Fever&#39;</span>: <span class="fl">0.4</span>}</span>
<span id="cb710-74"><a href="supplemental.html#cb710-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb710-75"><a href="supplemental.html#cb710-75" aria-hidden="true" tabindex="-1"></a>trans_p <span class="op">=</span> {</span>
<span id="cb710-76"><a href="supplemental.html#cb710-76" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Healthy&#39;</span> : {<span class="st">&#39;Healthy&#39;</span>: <span class="fl">0.7</span>, <span class="st">&#39;Fever&#39;</span>: <span class="fl">0.3</span>},</span>
<span id="cb710-77"><a href="supplemental.html#cb710-77" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Fever&#39;</span> : {<span class="st">&#39;Healthy&#39;</span>: <span class="fl">0.4</span>, <span class="st">&#39;Fever&#39;</span>: <span class="fl">0.6</span>}</span>
<span id="cb710-78"><a href="supplemental.html#cb710-78" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb710-79"><a href="supplemental.html#cb710-79" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb710-80"><a href="supplemental.html#cb710-80" aria-hidden="true" tabindex="-1"></a>emit_p <span class="op">=</span> {</span>
<span id="cb710-81"><a href="supplemental.html#cb710-81" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Healthy&#39;</span> : {<span class="st">&#39;normal&#39;</span>: <span class="fl">0.5</span>, <span class="st">&#39;cold&#39;</span>: <span class="fl">0.4</span>, <span class="st">&#39;dizzy&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb710-82"><a href="supplemental.html#cb710-82" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Fever&#39;</span> : {<span class="st">&#39;normal&#39;</span>: <span class="fl">0.1</span>, <span class="st">&#39;cold&#39;</span>: <span class="fl">0.3</span>, <span class="st">&#39;dizzy&#39;</span>: <span class="fl">0.6</span>}</span>
<span id="cb710-83"><a href="supplemental.html#cb710-83" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb710-84"><a href="supplemental.html#cb710-84" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb710-85"><a href="supplemental.html#cb710-85" aria-hidden="true" tabindex="-1"></a>viterbi(obs,states,start_p,trans_p,emit_p)</span></code></pre></div>
</div>
</div>
<div id="julia-demos" class="section level3">
<h3>Julia Demos</h3>
<p>I haven’t played with Julia in a very long time, but briefly hacked the old code to get something that worked. As Julia has gone though notable changes, it’s doubtful these are very good as far as Julia code goes, though conceptually they may still provide some utility. Perhaps at some point I’ll reteach myself the basics and come back to these. In any case the code did run on a <a href="https://jupyter.org/">Jupyter notebook</a>.</p>
<div id="mixed-models" class="section level4">
<h4>Mixed Models</h4>
<div id="one-factor" class="section level5">
<h5>One-factor</h5>
<div class="sourceCode" id="cb711"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb711-1"><a href="supplemental.html#cb711-1" aria-hidden="true" tabindex="-1"></a><span class="co">#####################</span></span>
<span id="cb711-2"><a href="supplemental.html#cb711-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Main function </span><span class="al">###</span></span>
<span id="cb711-3"><a href="supplemental.html#cb711-3" aria-hidden="true" tabindex="-1"></a><span class="co">#####################</span></span>
<span id="cb711-4"><a href="supplemental.html#cb711-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-5"><a href="supplemental.html#cb711-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> LinearAlgebra</span>
<span id="cb711-6"><a href="supplemental.html#cb711-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Statistics</span>
<span id="cb711-7"><a href="supplemental.html#cb711-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-8"><a href="supplemental.html#cb711-8" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> one_factor_re_loglike(par<span class="op">::</span><span class="dt">Vector</span>)    </span>
<span id="cb711-9"><a href="supplemental.html#cb711-9" aria-hidden="true" tabindex="-1"></a>    d<span class="op">,</span> ni <span class="op">=</span> size(y)</span>
<span id="cb711-10"><a href="supplemental.html#cb711-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> par[<span class="fl">1</span>]</span>
<span id="cb711-11"><a href="supplemental.html#cb711-11" aria-hidden="true" tabindex="-1"></a>    sigma2_mu <span class="op">=</span> par[<span class="fl">2</span>]</span>
<span id="cb711-12"><a href="supplemental.html#cb711-12" aria-hidden="true" tabindex="-1"></a>    sigma2 <span class="op">=</span> par[<span class="fl">3</span>]</span>
<span id="cb711-13"><a href="supplemental.html#cb711-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-14"><a href="supplemental.html#cb711-14" aria-hidden="true" tabindex="-1"></a>    Sigmai <span class="op">=</span> sigma2<span class="op">*</span>I(ni) <span class="op">+</span> sigma2_mu<span class="op">*</span>ones(ni<span class="op">,</span> ni)</span>
<span id="cb711-15"><a href="supplemental.html#cb711-15" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>(ni<span class="op">*</span>d)<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(<span class="fl">2</span><span class="op">*</span><span class="cn">pi</span>) <span class="op">-</span> d<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(det(Sigmai))</span>
<span id="cb711-16"><a href="supplemental.html#cb711-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb711-17"><a href="supplemental.html#cb711-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>d</span>
<span id="cb711-18"><a href="supplemental.html#cb711-18" aria-hidden="true" tabindex="-1"></a>      yi <span class="op">=</span> y[i<span class="op">,:</span>]</span>
<span id="cb711-19"><a href="supplemental.html#cb711-19" aria-hidden="true" tabindex="-1"></a>      l <span class="op">=</span> l <span class="op">-</span> <span class="fl">.5</span>(yi .<span class="op">-</span> mu)<span class="op">&#39;</span> <span class="op">*</span> (Sigmai<span class="op">\</span>(yi .<span class="op">-</span> mu))</span>
<span id="cb711-20"><a href="supplemental.html#cb711-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb711-21"><a href="supplemental.html#cb711-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb711-22"><a href="supplemental.html#cb711-22" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>l[<span class="fl">1</span>]</span>
<span id="cb711-23"><a href="supplemental.html#cb711-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb711-24"><a href="supplemental.html#cb711-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> l</span>
<span id="cb711-25"><a href="supplemental.html#cb711-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb712"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb712-1"><a href="supplemental.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="co">###################</span></span>
<span id="cb712-2"><a href="supplemental.html#cb712-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Data set up </span><span class="al">###</span></span>
<span id="cb712-3"><a href="supplemental.html#cb712-3" aria-hidden="true" tabindex="-1"></a><span class="co">###################</span></span>
<span id="cb712-4"><a href="supplemental.html#cb712-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-5"><a href="supplemental.html#cb712-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">22.6</span> <span class="fl">20.5</span> <span class="fl">20.8</span></span>
<span id="cb712-6"><a href="supplemental.html#cb712-6" aria-hidden="true" tabindex="-1"></a>     <span class="fl">22.6</span> <span class="fl">21.2</span> <span class="fl">20.5</span></span>
<span id="cb712-7"><a href="supplemental.html#cb712-7" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.3</span> <span class="fl">16.2</span> <span class="fl">16.6</span></span>
<span id="cb712-8"><a href="supplemental.html#cb712-8" aria-hidden="true" tabindex="-1"></a>     <span class="fl">21.4</span> <span class="fl">23.7</span> <span class="fl">23.2</span></span>
<span id="cb712-9"><a href="supplemental.html#cb712-9" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.9</span> <span class="fl">22.2</span> <span class="fl">22.6</span></span>
<span id="cb712-10"><a href="supplemental.html#cb712-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.5</span> <span class="fl">10.5</span> <span class="fl">12.3</span></span>
<span id="cb712-11"><a href="supplemental.html#cb712-11" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.8</span> <span class="fl">19.1</span> <span class="fl">21.3</span></span>
<span id="cb712-12"><a href="supplemental.html#cb712-12" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.4</span> <span class="fl">18.6</span> <span class="fl">18.6</span></span>
<span id="cb712-13"><a href="supplemental.html#cb712-13" aria-hidden="true" tabindex="-1"></a>     <span class="fl">25.1</span> <span class="fl">24.8</span> <span class="fl">24.9</span></span>
<span id="cb712-14"><a href="supplemental.html#cb712-14" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.9</span> <span class="fl">16.3</span> <span class="fl">16.6</span>]</span>
<span id="cb712-15"><a href="supplemental.html#cb712-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-16"><a href="supplemental.html#cb712-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-17"><a href="supplemental.html#cb712-17" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb712-18"><a href="supplemental.html#cb712-18" aria-hidden="true" tabindex="-1"></a><span class="co">### Starting values and test </span><span class="al">###</span></span>
<span id="cb712-19"><a href="supplemental.html#cb712-19" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb712-20"><a href="supplemental.html#cb712-20" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Statistics</span>
<span id="cb712-21"><a href="supplemental.html#cb712-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-22"><a href="supplemental.html#cb712-22" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> mean(y)</span>
<span id="cb712-23"><a href="supplemental.html#cb712-23" aria-hidden="true" tabindex="-1"></a>sigma2_mu0 <span class="op">=</span> var(mean(y<span class="op">,</span> dims <span class="op">=</span> <span class="fl">2</span>))</span>
<span id="cb712-24"><a href="supplemental.html#cb712-24" aria-hidden="true" tabindex="-1"></a>sigma20 <span class="op">=</span> mean(var(y<span class="op">,</span> dims <span class="op">=</span> <span class="fl">2</span>))</span>
<span id="cb712-25"><a href="supplemental.html#cb712-25" aria-hidden="true" tabindex="-1"></a>theta0  <span class="op">=</span> [mu0<span class="op">,</span> sigma2_mu0<span class="op">,</span> sigma20]</span>
<span id="cb712-26"><a href="supplemental.html#cb712-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-27"><a href="supplemental.html#cb712-27" aria-hidden="true" tabindex="-1"></a><span class="co">### test</span></span>
<span id="cb712-28"><a href="supplemental.html#cb712-28" aria-hidden="true" tabindex="-1"></a>one_factor_re_loglike(theta0)</span></code></pre></div>
<div class="sourceCode" id="cb713"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb713-1"><a href="supplemental.html#cb713-1" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb713-2"><a href="supplemental.html#cb713-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Run </span><span class="al">###</span></span>
<span id="cb713-3"><a href="supplemental.html#cb713-3" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb713-4"><a href="supplemental.html#cb713-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-5"><a href="supplemental.html#cb713-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Optim</span>
<span id="cb713-6"><a href="supplemental.html#cb713-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> optimize(one_factor_re_loglike<span class="op">,</span> theta0<span class="op">,</span> LBFGS())</span>
<span id="cb713-7"><a href="supplemental.html#cb713-7" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>
 * Status: success

 * Candidate solution
    Final objective value:     6.226441e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 2.93e-08 ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = 1.49e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 1.42e-14 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 2.28e-16 ≰ 0.0e+00
    |g(x)|                 = 1.17e-09 ≤ 1.0e-08

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    7
    f(x) calls:    22
    ∇f(x) calls:   22
  
  </code></pre>
<div class="sourceCode" id="cb715"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb715-1"><a href="supplemental.html#cb715-1" aria-hidden="true" tabindex="-1"></a>Optim.minimizer(res)</span></code></pre></div>
<pre><code>
3-element Array{Float64,1}:
19.599999980440952
12.193999992338886
1.1666666662195693</code></pre>
<div class="sourceCode" id="cb717"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb717-1"><a href="supplemental.html#cb717-1" aria-hidden="true" tabindex="-1"></a>Optim.minimum(res)</span></code></pre></div>
<pre><code>62.30661224610756</code></pre>
</div>
<div id="two-factor" class="section level5">
<h5>Two-factor</h5>
<div class="sourceCode" id="cb719"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb719-1"><a href="supplemental.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> LinearAlgebra</span>
<span id="cb719-2"><a href="supplemental.html#cb719-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Statistics</span>
<span id="cb719-3"><a href="supplemental.html#cb719-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-4"><a href="supplemental.html#cb719-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> sfran2_loglike(par<span class="op">::</span><span class="dt">Vector</span>)</span>
<span id="cb719-5"><a href="supplemental.html#cb719-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> length(y)</span>
<span id="cb719-6"><a href="supplemental.html#cb719-6" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> par[<span class="fl">1</span>]</span>
<span id="cb719-7"><a href="supplemental.html#cb719-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb719-8"><a href="supplemental.html#cb719-8" aria-hidden="true" tabindex="-1"></a>    sigma2_alpha <span class="op">=</span> exp(par[<span class="fl">2</span>])</span>
<span id="cb719-9"><a href="supplemental.html#cb719-9" aria-hidden="true" tabindex="-1"></a>    sigma2_gamma <span class="op">=</span> exp(par[<span class="fl">3</span>])</span>
<span id="cb719-10"><a href="supplemental.html#cb719-10" aria-hidden="true" tabindex="-1"></a>    sigma2 <span class="op">=</span> exp(par[<span class="fl">4</span>])</span>
<span id="cb719-11"><a href="supplemental.html#cb719-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-12"><a href="supplemental.html#cb719-12" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="op">=</span> sigma2<span class="op">*</span>I(n) <span class="op">+</span> sigma2_alpha<span class="op">*</span>(Xalpha <span class="op">*</span> Xalpha<span class="op">&#39;</span>) <span class="op">+</span> sigma2_gamma <span class="op">*</span> (Xgamma <span class="op">*</span> Xgamma<span class="op">&#39;</span>)</span>
<span id="cb719-13"><a href="supplemental.html#cb719-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-14"><a href="supplemental.html#cb719-14" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>n<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(<span class="fl">2</span><span class="op">*</span><span class="cn">pi</span>) <span class="op">-</span> sum(log.(diag(cholesky(Sigma).L))) <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(y .<span class="op">-</span> mu)<span class="op">&#39;</span> <span class="op">*</span> (Sigma<span class="op">\</span>(y .<span class="op">-</span> mu))</span>
<span id="cb719-15"><a href="supplemental.html#cb719-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb719-16"><a href="supplemental.html#cb719-16" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>l[<span class="fl">1</span>]</span>
<span id="cb719-17"><a href="supplemental.html#cb719-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> l</span>
<span id="cb719-18"><a href="supplemental.html#cb719-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb720"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb720-1"><a href="supplemental.html#cb720-1" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb720-2"><a href="supplemental.html#cb720-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Data setup </span><span class="al">###</span></span>
<span id="cb720-3"><a href="supplemental.html#cb720-3" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb720-4"><a href="supplemental.html#cb720-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">1.39</span><span class="op">,</span><span class="fl">1.29</span><span class="op">,</span><span class="fl">1.12</span><span class="op">,</span><span class="fl">1.16</span><span class="op">,</span><span class="fl">1.52</span><span class="op">,</span><span class="fl">1.62</span><span class="op">,</span><span class="fl">1.88</span><span class="op">,</span><span class="fl">1.87</span><span class="op">,</span><span class="fl">1.24</span><span class="op">,</span><span class="fl">1.18</span><span class="op">,</span></span>
<span id="cb720-5"><a href="supplemental.html#cb720-5" aria-hidden="true" tabindex="-1"></a>     <span class="fl">.95</span><span class="op">,</span><span class="fl">.96</span><span class="op">,</span><span class="fl">.82</span><span class="op">,</span><span class="fl">.92</span><span class="op">,</span><span class="fl">1.18</span><span class="op">,</span><span class="fl">1.20</span><span class="op">,</span><span class="fl">1.47</span><span class="op">,</span><span class="fl">1.41</span><span class="op">,</span><span class="fl">1.57</span><span class="op">,</span><span class="fl">1.65</span>]</span>
<span id="cb720-6"><a href="supplemental.html#cb720-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-7"><a href="supplemental.html#cb720-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-8"><a href="supplemental.html#cb720-8" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb720-9"><a href="supplemental.html#cb720-9" aria-hidden="true" tabindex="-1"></a><span class="co">### Starting values and test </span><span class="al">###</span></span>
<span id="cb720-10"><a href="supplemental.html#cb720-10" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb720-11"><a href="supplemental.html#cb720-11" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> mean(reshape(y<span class="op">,</span> <span class="fl">4</span><span class="op">,</span> <span class="fl">5</span>)<span class="op">,</span> <span class="fl">1</span>)</span>
<span id="cb720-12"><a href="supplemental.html#cb720-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-13"><a href="supplemental.html#cb720-13" aria-hidden="true" tabindex="-1"></a>theta0 <span class="op">=</span> [mean(y)<span class="op">,</span> log(var(yhat))<span class="op">,</span> log(var(y)<span class="op">/</span><span class="fl">3</span>)<span class="op">,</span> log(var(y)<span class="op">/</span><span class="fl">3</span>)]</span>
<span id="cb720-14"><a href="supplemental.html#cb720-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb720-15"><a href="supplemental.html#cb720-15" aria-hidden="true" tabindex="-1"></a>sfran2_loglike(theta0)</span></code></pre></div>
<div class="sourceCode" id="cb721"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb721-1"><a href="supplemental.html#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb721-2"><a href="supplemental.html#cb721-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Run </span><span class="al">###</span></span>
<span id="cb721-3"><a href="supplemental.html#cb721-3" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb721-4"><a href="supplemental.html#cb721-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Optim</span>
<span id="cb721-5"><a href="supplemental.html#cb721-5" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> optimize(sfran2_loglike<span class="op">,</span> theta0<span class="op">,</span> method <span class="op">=</span> <span class="op">:</span>l_bfgs)</span>
<span id="cb721-6"><a href="supplemental.html#cb721-6" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>
 * Status: success

 * Candidate solution
    Final objective value:     -1.199315e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 6.60e-09 ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = 1.08e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 5.33e-15 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 4.44e-16 ≰ 0.0e+00
    |g(x)|                 = 7.02e-10 ≤ 1.0e-08

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    9
    f(x) calls:    23
    ∇f(x) calls:   23</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb723-1"><a href="supplemental.html#cb723-1" aria-hidden="true" tabindex="-1"></a>exp.(Optim.minimizer(res))</span></code></pre></div>
<pre><code>
4-element Array{Float64,1}:
 3.7434213772629223
 0.053720000000540405
 0.031790000003692476
 0.002290000000530042</code></pre>
<div class="sourceCode" id="cb725"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb725-1"><a href="supplemental.html#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">2</span><span class="op">*</span>Optim.minimum(res)</span></code></pre></div>
<pre><code>23.98630759443859</code></pre>
</div>
</div>
</div>
<div id="matlab-demos" class="section level3">
<h3>Matlab Demos</h3>
<p>I don’t code in Matlab, nor have any particular desire to, so this is provided here just for reference.</p>
<div id="mixed-models-1" class="section level4">
<h4>Mixed Models</h4>
<div id="one-factor-1" class="section level5">
<h5>One-factor</h5>
<div class="sourceCode" id="cb727"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb727-1"><a href="supplemental.html#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="co">% matlab from Statistical Modeling and Computation (2014 p 311).  See the </span></span>
<span id="cb727-2"><a href="supplemental.html#cb727-2" aria-hidden="true" tabindex="-1"></a><span class="co">% associated twofactorRE.R file for details.</span></span>
<span id="cb727-3"><a href="supplemental.html#cb727-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-4"><a href="supplemental.html#cb727-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">one_factor_re_loglike</span>(<span class="va">mu</span><span class="op">,</span> <span class="va">sigma2_mu</span><span class="op">,</span> <span class="va">sigma2</span><span class="op">,</span> <span class="va">y</span>)</span>
<span id="cb727-5"><a href="supplemental.html#cb727-5" aria-hidden="true" tabindex="-1"></a>    [<span class="va">d</span> <span class="va">ni</span>] <span class="op">=</span> <span class="va">size</span>(<span class="va">y</span>)<span class="op">;</span></span>
<span id="cb727-6"><a href="supplemental.html#cb727-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Sigmai</span> <span class="op">=</span> <span class="va">sigma2</span><span class="op">*</span><span class="va">eye</span>(<span class="va">ni</span>) <span class="op">+</span> <span class="va">sigma2_mu</span><span class="op">*</span><span class="va">ones</span>(<span class="va">ni</span><span class="op">,</span><span class="va">ni</span>)<span class="op">;</span></span>
<span id="cb727-7"><a href="supplemental.html#cb727-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">l</span> <span class="op">=</span> <span class="op">-</span>(<span class="va">ni</span><span class="op">*</span><span class="va">d</span>) <span class="op">/</span> <span class="fl">2</span><span class="op">*</span><span class="va">log</span>(<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>) <span class="op">-</span> <span class="va">d</span> <span class="op">/</span> <span class="fl">2</span><span class="op">*</span><span class="va">log</span>(<span class="va">det</span>(<span class="va">Sigmai</span>))<span class="op">;</span></span>
<span id="cb727-8"><a href="supplemental.html#cb727-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span></span>
<span id="cb727-9"><a href="supplemental.html#cb727-9" aria-hidden="true" tabindex="-1"></a>      <span class="va">yi</span> <span class="op">=</span> <span class="va">y</span>(<span class="va">i</span><span class="op">,</span> <span class="op">:</span>)<span class="op">&#39;;</span></span>
<span id="cb727-10"><a href="supplemental.html#cb727-10" aria-hidden="true" tabindex="-1"></a>      <span class="va">l</span> <span class="op">=</span> <span class="va">l</span> <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(<span class="va">yi</span> <span class="op">-</span> <span class="va">mu</span>)<span class="op">&#39;</span> <span class="op">*</span> (<span class="va">Sigmai</span><span class="op">\</span>(<span class="va">yi</span> <span class="op">-</span> <span class="va">mu</span>))<span class="op">;</span></span>
<span id="cb727-11"><a href="supplemental.html#cb727-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb727-12"><a href="supplemental.html#cb727-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb727-13"><a href="supplemental.html#cb727-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-14"><a href="supplemental.html#cb727-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-15"><a href="supplemental.html#cb727-15" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">22.6</span> <span class="fl">20.5</span> <span class="fl">20.8</span><span class="op">;</span></span>
<span id="cb727-16"><a href="supplemental.html#cb727-16" aria-hidden="true" tabindex="-1"></a>     <span class="fl">22.6</span> <span class="fl">21.2</span> <span class="fl">20.5</span><span class="op">;</span></span>
<span id="cb727-17"><a href="supplemental.html#cb727-17" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.3</span> <span class="fl">16.2</span> <span class="fl">16.6</span><span class="op">;</span></span>
<span id="cb727-18"><a href="supplemental.html#cb727-18" aria-hidden="true" tabindex="-1"></a>     <span class="fl">21.4</span> <span class="fl">23.7</span> <span class="fl">23.2</span><span class="op">;</span></span>
<span id="cb727-19"><a href="supplemental.html#cb727-19" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.9</span> <span class="fl">22.2</span> <span class="fl">22.6</span><span class="op">;</span></span>
<span id="cb727-20"><a href="supplemental.html#cb727-20" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.5</span> <span class="fl">10.5</span> <span class="fl">12.3</span><span class="op">;</span></span>
<span id="cb727-21"><a href="supplemental.html#cb727-21" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.8</span> <span class="fl">19.1</span> <span class="fl">21.3</span><span class="op">;</span></span>
<span id="cb727-22"><a href="supplemental.html#cb727-22" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.4</span> <span class="fl">18.6</span> <span class="fl">18.6</span><span class="op">;</span></span>
<span id="cb727-23"><a href="supplemental.html#cb727-23" aria-hidden="true" tabindex="-1"></a>     <span class="fl">25.1</span> <span class="fl">24.8</span> <span class="fl">24.9</span><span class="op">;</span></span>
<span id="cb727-24"><a href="supplemental.html#cb727-24" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.9</span> <span class="fl">16.3</span> <span class="fl">16.6</span>]<span class="op">;</span></span>
<span id="cb727-25"><a href="supplemental.html#cb727-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-26"><a href="supplemental.html#cb727-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb727-27"><a href="supplemental.html#cb727-27" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">theta</span>) <span class="op">-</span><span class="va">one_factor_re_loglike</span>(<span class="va">theta</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">2</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="va">y</span>)<span class="op">;</span></span>
<span id="cb727-28"><a href="supplemental.html#cb727-28" aria-hidden="true" tabindex="-1"></a><span class="va">ybar</span> <span class="op">=</span> <span class="va">mean</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb727-29"><a href="supplemental.html#cb727-29" aria-hidden="true" tabindex="-1"></a><span class="va">theta0</span> <span class="op">=</span> [<span class="va">mean</span>(<span class="va">ybar</span>) <span class="va">var</span>(<span class="va">ybar</span>) <span class="va">mean</span>(<span class="va">var</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">2</span>))]<span class="op">;</span></span>
<span id="cb727-30"><a href="supplemental.html#cb727-30" aria-hidden="true" tabindex="-1"></a><span class="va">thetahat</span> <span class="op">=</span> <span class="va">fminsearch</span>(<span class="va">f</span><span class="op">,</span> <span class="va">theta0</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="two-factor-1" class="section level5">
<h5>Two-factor</h5>
<div class="sourceCode" id="cb728"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb728-1"><a href="supplemental.html#cb728-1" aria-hidden="true" tabindex="-1"></a><span class="co">% matlab from Statistical Modeling and Computation (2014 p 314). See the </span></span>
<span id="cb728-2"><a href="supplemental.html#cb728-2" aria-hidden="true" tabindex="-1"></a><span class="co">% associated twofactorRE.R file for details.</span></span>
<span id="cb728-3"><a href="supplemental.html#cb728-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-4"><a href="supplemental.html#cb728-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">sfran2_loglike</span>(<span class="va">mu</span><span class="op">,</span> <span class="va">eta_alpha</span><span class="op">,</span> <span class="va">eta_gamma</span><span class="op">,</span> <span class="va">eta</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">Xalpha</span><span class="op">,</span> <span class="va">Xgamma</span>)</span>
<span id="cb728-5"><a href="supplemental.html#cb728-5" aria-hidden="true" tabindex="-1"></a>  <span class="va">sigma2_alpha</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta_alpha</span>)<span class="op">;</span></span>
<span id="cb728-6"><a href="supplemental.html#cb728-6" aria-hidden="true" tabindex="-1"></a>  <span class="va">sigma2_gamma</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta_gamma</span>)<span class="op">;</span></span>
<span id="cb728-7"><a href="supplemental.html#cb728-7" aria-hidden="true" tabindex="-1"></a>  <span class="va">sigma2</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta</span>)<span class="op">;</span></span>
<span id="cb728-8"><a href="supplemental.html#cb728-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb728-9"><a href="supplemental.html#cb728-9" aria-hidden="true" tabindex="-1"></a>  <span class="va">n</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">y</span>)<span class="op">;</span></span>
<span id="cb728-10"><a href="supplemental.html#cb728-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb728-11"><a href="supplemental.html#cb728-11" aria-hidden="true" tabindex="-1"></a>  <span class="va">Sigma</span> <span class="op">=</span> <span class="va">sigma2</span><span class="op">*</span><span class="va">speye</span>(<span class="va">n</span>) <span class="op">+</span> <span class="va">sigma2_alpha</span> <span class="op">*</span> (<span class="va">Xalpha</span> <span class="op">*</span> <span class="va">Xalpha</span><span class="op">&#39;</span>) <span class="op">+</span> <span class="va">sigma2_gamma</span> <span class="op">*</span> (<span class="va">Xgamma</span><span class="op">*</span><span class="va">Xgamma</span><span class="op">&#39;</span>)<span class="op">;</span></span>
<span id="cb728-12"><a href="supplemental.html#cb728-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb728-13"><a href="supplemental.html#cb728-13" aria-hidden="true" tabindex="-1"></a>  <span class="va">l</span> <span class="op">=</span> <span class="op">-</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span> <span class="op">*</span> <span class="va">log</span>(<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>) <span class="op">-</span> <span class="va">sum</span>(<span class="va">log</span>(<span class="va">diag</span>(<span class="va">chol</span>(<span class="va">Sigma</span>)))) <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(<span class="va">y</span> <span class="op">-</span> <span class="va">mu</span>)<span class="op">&#39;</span> <span class="op">*</span> (<span class="va">Sigma</span><span class="op">\</span>(<span class="va">y</span> <span class="op">-</span> <span class="va">mu</span>))<span class="op">;</span></span>
<span id="cb728-14"><a href="supplemental.html#cb728-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb728-15"><a href="supplemental.html#cb728-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb728-16"><a href="supplemental.html#cb728-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-17"><a href="supplemental.html#cb728-17" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">1.39</span> <span class="fl">1.29</span> <span class="fl">1.12</span> <span class="fl">1.16</span> <span class="fl">1.52</span> <span class="fl">1.62</span> <span class="fl">1.88</span> <span class="fl">1.87</span> <span class="fl">1.24</span> <span class="fl">1.18</span> <span class="fl">.95</span> <span class="fl">.96</span> <span class="fl">.82</span> <span class="fl">.92</span> <span class="fl">1.18</span> <span class="fl">1.20</span> <span class="fl">1.47</span> <span class="fl">1.41</span> <span class="fl">1.57</span> <span class="fl">1.65</span>]<span class="op">;</span></span>
<span id="cb728-18"><a href="supplemental.html#cb728-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-19"><a href="supplemental.html#cb728-19" aria-hidden="true" tabindex="-1"></a><span class="va">Xalpha</span> <span class="op">=</span> <span class="va">kron</span>(<span class="va">speye</span>(<span class="fl">5</span>)<span class="op">,</span>  <span class="va">ones</span>(<span class="fl">4</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb728-20"><a href="supplemental.html#cb728-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-21"><a href="supplemental.html#cb728-21" aria-hidden="true" tabindex="-1"></a><span class="va">Xgamma</span> <span class="op">=</span> <span class="va">kron</span>(<span class="va">speye</span>(<span class="fl">10</span>)<span class="op">,</span> <span class="va">ones</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb728-22"><a href="supplemental.html#cb728-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-23"><a href="supplemental.html#cb728-23" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">theta</span>) <span class="op">-</span><span class="va">sfran_loglike</span>(<span class="va">theta</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">2</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">4</span>)<span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">Xalpha</span><span class="op">,</span> <span class="va">Xgamma</span>)<span class="op">;</span></span>
<span id="cb728-24"><a href="supplemental.html#cb728-24" aria-hidden="true" tabindex="-1"></a><span class="va">yhat</span>     <span class="op">=</span> <span class="va">mean</span>(<span class="va">reshape</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span> <span class="fl">5</span>))<span class="op">;</span></span>
<span id="cb728-25"><a href="supplemental.html#cb728-25" aria-hidden="true" tabindex="-1"></a><span class="va">theta0</span>   <span class="op">=</span> [<span class="va">mean</span>(<span class="va">y</span>) <span class="va">log</span>(<span class="va">var</span>(<span class="va">yhat</span>)) <span class="va">log</span>(<span class="va">var</span>(<span class="va">y</span>)<span class="op">/</span><span class="fl">3</span>) <span class="va">log</span>(<span class="va">var</span>(<span class="va">y</span>)<span class="op">/</span><span class="fl">3</span>)]<span class="op">;</span></span>
<span id="cb728-26"><a href="supplemental.html#cb728-26" aria-hidden="true" tabindex="-1"></a><span class="va">thetahat</span> <span class="op">=</span> <span class="va">fminsearch</span>(<span class="va">f</span><span class="op">,</span> <span class="va">theta0</span>)</span></code></pre></div>
</div>
</div>
<div id="gaussian-processes" class="section level4">
<h4>Gaussian Processes</h4>
<p>Any updates on the following can be found at the <a href="https://github.com/probml/pmtk3">repo</a>.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb729-1"><a href="supplemental.html#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">S</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">arg1</span><span class="op">,</span> <span class="va">arg2</span><span class="op">,</span> <span class="va">arg3</span>)</span>
<span id="cb729-2"><a href="supplemental.html#cb729-2" aria-hidden="true" tabindex="-1"></a><span class="co">% Returns n samples (in the rows) from a multivariate Gaussian distribution</span></span>
<span id="cb729-3"><a href="supplemental.html#cb729-3" aria-hidden="true" tabindex="-1"></a><span class="co">%</span></span>
<span id="cb729-4"><a href="supplemental.html#cb729-4" aria-hidden="true" tabindex="-1"></a><span class="co">% Examples:</span></span>
<span id="cb729-5"><a href="supplemental.html#cb729-5" aria-hidden="true" tabindex="-1"></a><span class="co">% S = gaussSample(mu, Sigma, 10)</span></span>
<span id="cb729-6"><a href="supplemental.html#cb729-6" aria-hidden="true" tabindex="-1"></a><span class="co">% S = gaussSample(model, 100)</span></span>
<span id="cb729-7"><a href="supplemental.html#cb729-7" aria-hidden="true" tabindex="-1"></a><span class="co">% S = gaussSample(struct(&#39;mu&#39;,[0], &#39;Sigma&#39;, eye(1)), 3)</span></span>
<span id="cb729-8"><a href="supplemental.html#cb729-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-9"><a href="supplemental.html#cb729-9" aria-hidden="true" tabindex="-1"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb729-10"><a href="supplemental.html#cb729-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-11"><a href="supplemental.html#cb729-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-12"><a href="supplemental.html#cb729-12" aria-hidden="true" tabindex="-1"></a><span class="kw">switch</span> <span class="va">nargin</span></span>
<span id="cb729-13"><a href="supplemental.html#cb729-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="fl">3</span><span class="op">,</span>  <span class="va">mu</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">arg2</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="va">arg3</span><span class="op">;</span></span>
<span id="cb729-14"><a href="supplemental.html#cb729-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="fl">2</span><span class="op">,</span> <span class="va">model</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">mu</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">mu</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">Sigma</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="va">arg2</span><span class="op">;</span></span>
<span id="cb729-15"><a href="supplemental.html#cb729-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="fl">1</span><span class="op">,</span> <span class="va">model</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">mu</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">mu</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">Sigma</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span> </span>
<span id="cb729-16"><a href="supplemental.html#cb729-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">otherwise</span></span>
<span id="cb729-17"><a href="supplemental.html#cb729-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">error</span>(<span class="ss">&#39;bad num args&#39;</span>)</span>
<span id="cb729-18"><a href="supplemental.html#cb729-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb729-19"><a href="supplemental.html#cb729-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-20"><a href="supplemental.html#cb729-20" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="op">=</span> <span class="va">chol</span>(<span class="va">Sigma</span><span class="op">,</span> <span class="ss">&#39;lower&#39;</span>)<span class="op">;</span></span>
<span id="cb729-21"><a href="supplemental.html#cb729-21" aria-hidden="true" tabindex="-1"></a><span class="va">Z</span> <span class="op">=</span> <span class="va">randn</span>(<span class="va">length</span>(<span class="va">mu</span>)<span class="op">,</span> <span class="va">n</span>)<span class="op">;</span></span>
<span id="cb729-22"><a href="supplemental.html#cb729-22" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="va">bsxfun</span>(<span class="op">@</span><span class="va">plus</span><span class="op">,</span> <span class="va">mu</span>(<span class="op">:</span>)<span class="op">,</span> <span class="va">A</span><span class="op">*</span><span class="va">Z</span>)<span class="op">&#39;;</span></span>
<span id="cb729-23"><a href="supplemental.html#cb729-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-24"><a href="supplemental.html#cb729-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-25"><a href="supplemental.html#cb729-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb730"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb730-1"><a href="supplemental.html#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Visualize the effect of change the hyper-params for a 1d GP regression</span></span>
<span id="cb730-2"><a href="supplemental.html#cb730-2" aria-hidden="true" tabindex="-1"></a><span class="co">% based on demo_gpr by Carl Rasmussen</span></span>
<span id="cb730-3"><a href="supplemental.html#cb730-3" aria-hidden="true" tabindex="-1"></a><span class="co">%</span></span>
<span id="cb730-4"><a href="supplemental.html#cb730-4" aria-hidden="true" tabindex="-1"></a><span class="co">%% Generate data</span></span>
<span id="cb730-5"><a href="supplemental.html#cb730-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-6"><a href="supplemental.html#cb730-6" aria-hidden="true" tabindex="-1"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb730-7"><a href="supplemental.html#cb730-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-8"><a href="supplemental.html#cb730-8" aria-hidden="true" tabindex="-1"></a><span class="va">n</span> <span class="op">=</span> <span class="fl">20</span><span class="op">;</span></span>
<span id="cb730-9"><a href="supplemental.html#cb730-9" aria-hidden="true" tabindex="-1"></a><span class="va">rand</span>(<span class="ss">&#39;state&#39;</span><span class="op">,</span><span class="fl">18</span>)<span class="op">;</span></span>
<span id="cb730-10"><a href="supplemental.html#cb730-10" aria-hidden="true" tabindex="-1"></a><span class="va">randn</span>(<span class="ss">&#39;state&#39;</span><span class="op">,</span><span class="fl">20</span>)<span class="op">;</span></span>
<span id="cb730-11"><a href="supplemental.html#cb730-11" aria-hidden="true" tabindex="-1"></a><span class="va">covfunc</span> <span class="op">=</span> {<span class="ss">&#39;covSum&#39;</span><span class="op">,</span> {<span class="ss">&#39;covSEiso&#39;</span><span class="op">,</span><span class="ss">&#39;covNoise&#39;</span>}}<span class="op">;</span></span>
<span id="cb730-12"><a href="supplemental.html#cb730-12" aria-hidden="true" tabindex="-1"></a><span class="va">loghyper</span> <span class="op">=</span> [<span class="va">log</span>(<span class="fl">1.0</span>)<span class="op">;</span> <span class="va">log</span>(<span class="fl">1.0</span>)<span class="op">;</span> <span class="va">log</span>(<span class="fl">0.1</span>)]<span class="op">;</span></span>
<span id="cb730-13"><a href="supplemental.html#cb730-13" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">=</span> <span class="fl">15</span><span class="op">*</span>(<span class="va">rand</span>(<span class="va">n</span><span class="op">,</span><span class="fl">1</span>)<span class="op">-</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb730-14"><a href="supplemental.html#cb730-14" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> <span class="va">chol</span>(<span class="va">feval</span>(<span class="va">covfunc</span>{<span class="op">:</span>}<span class="op">,</span> <span class="va">loghyper</span><span class="op">,</span> <span class="va">x</span>))<span class="op">&#39;*</span><span class="va">randn</span>(<span class="va">n</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span>        <span class="co">% Cholesky decomp.</span></span>
<span id="cb730-15"><a href="supplemental.html#cb730-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-16"><a href="supplemental.html#cb730-16" aria-hidden="true" tabindex="-1"></a><span class="va">xstar</span> <span class="op">=</span> <span class="va">linspace</span>(<span class="op">-</span><span class="fl">7.5</span><span class="op">,</span> <span class="fl">7.5</span><span class="op">,</span> <span class="fl">201</span>)<span class="op">&#39;;</span></span>
<span id="cb730-17"><a href="supplemental.html#cb730-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-18"><a href="supplemental.html#cb730-18" aria-hidden="true" tabindex="-1"></a><span class="va">hyps</span> <span class="op">=</span> [<span class="va">log</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">log</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">log</span>(<span class="fl">0.1</span>)<span class="op">;...</span></span>
<span id="cb730-19"><a href="supplemental.html#cb730-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">log</span>(<span class="fl">0.3</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">1.08</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">0.00005</span>)<span class="op">;...</span></span>
<span id="cb730-20"><a href="supplemental.html#cb730-20" aria-hidden="true" tabindex="-1"></a>  <span class="va">log</span>(<span class="fl">3</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">1.16</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">0.89</span>)]<span class="op">;</span></span>
<span id="cb730-21"><a href="supplemental.html#cb730-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-22"><a href="supplemental.html#cb730-22" aria-hidden="true" tabindex="-1"></a><span class="co">%% compute post pred and plot marginals</span></span>
<span id="cb730-23"><a href="supplemental.html#cb730-23" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">size</span>(<span class="va">hyps</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb730-24"><a href="supplemental.html#cb730-24" aria-hidden="true" tabindex="-1"></a>  <span class="va">loghyper</span> <span class="op">=</span> <span class="va">hyps</span>(<span class="va">i</span><span class="op">,:</span>)<span class="op">&#39;;</span></span>
<span id="cb730-25"><a href="supplemental.html#cb730-25" aria-hidden="true" tabindex="-1"></a>  [<span class="va">mu</span><span class="op">,</span> <span class="va">S2</span>] <span class="op">=</span> <span class="va">gpr</span>(<span class="va">loghyper</span><span class="op">,</span> <span class="va">covfunc</span><span class="op">,</span> <span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">xstar</span>)<span class="op">;</span></span>
<span id="cb730-26"><a href="supplemental.html#cb730-26" aria-hidden="true" tabindex="-1"></a>  <span class="va">S2</span> <span class="op">=</span> <span class="va">S2</span> <span class="op">-</span> <span class="va">exp</span>(<span class="fl">2</span><span class="op">*</span><span class="va">loghyper</span>(<span class="fl">3</span>))<span class="op">;</span> <span class="co">% remove observation noise</span></span>
<span id="cb730-27"><a href="supplemental.html#cb730-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb730-28"><a href="supplemental.html#cb730-28" aria-hidden="true" tabindex="-1"></a>  <span class="va">figure</span><span class="op">;</span></span>
<span id="cb730-29"><a href="supplemental.html#cb730-29" aria-hidden="true" tabindex="-1"></a>  <span class="va">f</span> <span class="op">=</span> [<span class="va">mu</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">;</span><span class="va">flipdim</span>(<span class="va">mu</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">,</span><span class="fl">1</span>)]<span class="op">;</span></span>
<span id="cb730-30"><a href="supplemental.html#cb730-30" aria-hidden="true" tabindex="-1"></a>  <span class="va">fill</span>([<span class="va">xstar</span><span class="op">;</span> <span class="va">flipdim</span>(<span class="va">xstar</span><span class="op">,</span><span class="fl">1</span>)]<span class="op">,</span> <span class="va">f</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span><span class="op">,</span> <span class="ss">&#39;EdgeColor&#39;</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb730-31"><a href="supplemental.html#cb730-31" aria-hidden="true" tabindex="-1"></a>  <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb730-32"><a href="supplemental.html#cb730-32" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">xstar</span><span class="op">,</span><span class="va">mu</span><span class="op">,</span><span class="ss">&#39;k-&#39;</span><span class="op">,</span><span class="ss">&#39;LineWidth&#39;</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb730-33"><a href="supplemental.html#cb730-33" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="ss">&#39;k+&#39;</span><span class="op">,</span> <span class="ss">&#39;MarkerSize&#39;</span><span class="op">,</span> <span class="fl">17</span>)<span class="op">;</span></span>
<span id="cb730-34"><a href="supplemental.html#cb730-34" aria-hidden="true" tabindex="-1"></a>  <span class="va">axis</span>([<span class="op">-</span><span class="fl">8</span> <span class="fl">8</span> <span class="op">-</span><span class="fl">3</span> <span class="fl">3</span>])</span>
<span id="cb730-35"><a href="supplemental.html#cb730-35" aria-hidden="true" tabindex="-1"></a>  <span class="va">printPmtkFigure</span>(<span class="va">sprintf</span>(<span class="ss">&#39;gprDemoChangeHparams%d&#39;</span><span class="op">,</span> <span class="va">i</span>))<span class="op">;</span></span>
<span id="cb730-36"><a href="supplemental.html#cb730-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb731"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb731-1"><a href="supplemental.html#cb731-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Reproduce figure 2.2 from GP book</span></span>
<span id="cb731-2"><a href="supplemental.html#cb731-2" aria-hidden="true" tabindex="-1"></a><span class="co">%</span></span>
<span id="cb731-3"><a href="supplemental.html#cb731-3" aria-hidden="true" tabindex="-1"></a><span class="co">%%</span></span>
<span id="cb731-4"><a href="supplemental.html#cb731-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-5"><a href="supplemental.html#cb731-5" aria-hidden="true" tabindex="-1"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb731-6"><a href="supplemental.html#cb731-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-7"><a href="supplemental.html#cb731-7" aria-hidden="true" tabindex="-1"></a><span class="va">setSeed</span>(<span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb731-8"><a href="supplemental.html#cb731-8" aria-hidden="true" tabindex="-1"></a><span class="va">L</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb731-9"><a href="supplemental.html#cb731-9" aria-hidden="true" tabindex="-1"></a><span class="va">xs</span> <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="fl">0.2</span><span class="op">:</span><span class="fl">5</span>)<span class="op">&#39;;</span></span>
<span id="cb731-10"><a href="supplemental.html#cb731-10" aria-hidden="true" tabindex="-1"></a><span class="va">ns</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">xs</span>)<span class="op">;</span></span>
<span id="cb731-11"><a href="supplemental.html#cb731-11" aria-hidden="true" tabindex="-1"></a><span class="va">keps</span> <span class="op">=</span> <span class="fl">1e-8</span><span class="op">;</span></span>
<span id="cb731-12"><a href="supplemental.html#cb731-12" aria-hidden="true" tabindex="-1"></a><span class="va">muFn</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="fl">0</span><span class="op">*</span><span class="va">x</span>(<span class="op">:</span>)<span class="op">.^</span><span class="fl">2</span><span class="op">;</span></span>
<span id="cb731-13"><a href="supplemental.html#cb731-13" aria-hidden="true" tabindex="-1"></a><span class="va">Kfn</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">x</span><span class="op">,</span><span class="va">z</span>) <span class="fl">1</span><span class="op">*</span><span class="va">exp</span>(<span class="op">-</span><span class="va">sq_dist</span>(<span class="va">x</span><span class="op">&#39;/</span><span class="va">L</span><span class="op">,</span><span class="va">z</span><span class="op">&#39;/</span><span class="va">L</span>)<span class="op">/</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb731-14"><a href="supplemental.html#cb731-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-15"><a href="supplemental.html#cb731-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-16"><a href="supplemental.html#cb731-16" aria-hidden="true" tabindex="-1"></a><span class="co">% plot sampled functions from the prior</span></span>
<span id="cb731-17"><a href="supplemental.html#cb731-17" aria-hidden="true" tabindex="-1"></a><span class="va">figure</span><span class="op">;</span> <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb731-18"><a href="supplemental.html#cb731-18" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb731-19"><a href="supplemental.html#cb731-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">model</span> <span class="op">=</span> <span class="va">struct</span>(<span class="ss">&#39;mu&#39;</span><span class="op">,</span> <span class="va">muFn</span>(<span class="va">xs</span>)<span class="op">,</span> <span class="ss">&#39;Sigma&#39;</span><span class="op">,</span>  <span class="va">Kfn</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">xs</span>) <span class="op">+</span> <span class="fl">1e-15</span><span class="op">*</span><span class="va">eye</span>(<span class="va">size</span>(<span class="va">xs</span><span class="op">,</span> <span class="fl">1</span>)))<span class="op">;</span></span>
<span id="cb731-20"><a href="supplemental.html#cb731-20" aria-hidden="true" tabindex="-1"></a>  <span class="va">fs</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">model</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb731-21"><a href="supplemental.html#cb731-21" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">fs</span><span class="op">,</span> <span class="ss">&#39;k-&#39;</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">2</span>)</span>
<span id="cb731-22"><a href="supplemental.html#cb731-22" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb731-23"><a href="supplemental.html#cb731-23" aria-hidden="true" tabindex="-1"></a><span class="va">printPmtkFigure</span>(<span class="ss">&#39;gprDemoNoiseFreePrior&#39;</span>)</span>
<span id="cb731-24"><a href="supplemental.html#cb731-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-25"><a href="supplemental.html#cb731-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-26"><a href="supplemental.html#cb731-26" aria-hidden="true" tabindex="-1"></a><span class="co">% generate noise-less training data</span></span>
<span id="cb731-27"><a href="supplemental.html#cb731-27" aria-hidden="true" tabindex="-1"></a><span class="va">Xtrain</span> <span class="op">=</span> [<span class="op">-</span><span class="fl">4</span><span class="op">,</span> <span class="op">-</span><span class="fl">3</span><span class="op">,</span> <span class="op">-</span><span class="fl">2</span><span class="op">,</span> <span class="op">-</span><span class="fl">1</span><span class="op">,</span> <span class="fl">1</span>]<span class="op">&#39;;</span></span>
<span id="cb731-28"><a href="supplemental.html#cb731-28" aria-hidden="true" tabindex="-1"></a><span class="va">ftrain</span> <span class="op">=</span> <span class="va">sin</span>(<span class="va">Xtrain</span>)<span class="op">;</span></span>
<span id="cb731-29"><a href="supplemental.html#cb731-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-30"><a href="supplemental.html#cb731-30" aria-hidden="true" tabindex="-1"></a><span class="co">% compute posterior predictive</span></span>
<span id="cb731-31"><a href="supplemental.html#cb731-31" aria-hidden="true" tabindex="-1"></a><span class="va">K</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">Xtrain</span>)<span class="op">;</span> <span class="co">% K</span></span>
<span id="cb731-32"><a href="supplemental.html#cb731-32" aria-hidden="true" tabindex="-1"></a><span class="va">Ks</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">xs</span>)<span class="op">;</span> <span class="co">%K_*</span></span>
<span id="cb731-33"><a href="supplemental.html#cb731-33" aria-hidden="true" tabindex="-1"></a><span class="va">Kss</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">xs</span>) <span class="op">+</span> <span class="va">keps</span><span class="op">*</span><span class="va">eye</span>(<span class="va">length</span>(<span class="va">xs</span>))<span class="op">;</span> <span class="co">% K_** (keps is essential!)</span></span>
<span id="cb731-34"><a href="supplemental.html#cb731-34" aria-hidden="true" tabindex="-1"></a><span class="va">Ki</span> <span class="op">=</span> <span class="va">inv</span>(<span class="va">K</span>)<span class="op">;</span></span>
<span id="cb731-35"><a href="supplemental.html#cb731-35" aria-hidden="true" tabindex="-1"></a><span class="va">postMu</span> <span class="op">=</span> <span class="va">muFn</span>(<span class="va">xs</span>) <span class="op">+</span> <span class="va">Ks</span><span class="op">&#39;*</span><span class="va">Ki</span><span class="op">*</span>(<span class="va">ftrain</span> <span class="op">-</span> <span class="va">muFn</span>(<span class="va">Xtrain</span>))<span class="op">;</span></span>
<span id="cb731-36"><a href="supplemental.html#cb731-36" aria-hidden="true" tabindex="-1"></a><span class="va">postCov</span> <span class="op">=</span> <span class="va">Kss</span> <span class="op">-</span> <span class="va">Ks</span><span class="op">&#39;*</span><span class="va">Ki</span><span class="op">*</span><span class="va">Ks</span><span class="op">;</span></span>
<span id="cb731-37"><a href="supplemental.html#cb731-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-38"><a href="supplemental.html#cb731-38" aria-hidden="true" tabindex="-1"></a><span class="va">figure</span><span class="op">;</span> <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb731-39"><a href="supplemental.html#cb731-39" aria-hidden="true" tabindex="-1"></a><span class="co">% plot marginal posterior variance as gray band</span></span>
<span id="cb731-40"><a href="supplemental.html#cb731-40" aria-hidden="true" tabindex="-1"></a><span class="va">mu</span> <span class="op">=</span> <span class="va">postMu</span>(<span class="op">:</span>)<span class="op">;</span></span>
<span id="cb731-41"><a href="supplemental.html#cb731-41" aria-hidden="true" tabindex="-1"></a><span class="va">S2</span> <span class="op">=</span> <span class="va">diag</span>(<span class="va">postCov</span>)<span class="op">;</span></span>
<span id="cb731-42"><a href="supplemental.html#cb731-42" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> [<span class="va">mu</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">;</span><span class="va">flipdim</span>(<span class="va">mu</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">,</span><span class="fl">1</span>)]<span class="op">;</span></span>
<span id="cb731-43"><a href="supplemental.html#cb731-43" aria-hidden="true" tabindex="-1"></a><span class="va">fill</span>([<span class="va">xs</span><span class="op">;</span> <span class="va">flipdim</span>(<span class="va">xs</span><span class="op">,</span><span class="fl">1</span>)]<span class="op">,</span> <span class="va">f</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span><span class="op">,</span> <span class="ss">&#39;EdgeColor&#39;</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb731-44"><a href="supplemental.html#cb731-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-45"><a href="supplemental.html#cb731-45" aria-hidden="true" tabindex="-1"></a><span class="co">% plot samples from posterior predictive</span></span>
<span id="cb731-46"><a href="supplemental.html#cb731-46" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb731-47"><a href="supplemental.html#cb731-47" aria-hidden="true" tabindex="-1"></a>  <span class="va">model</span> <span class="op">=</span> <span class="va">struct</span>(<span class="ss">&#39;mu&#39;</span><span class="op">,</span> <span class="va">postMu</span>(<span class="op">:</span>)<span class="op">&#39;,</span> <span class="ss">&#39;Sigma&#39;</span><span class="op">,</span> <span class="va">postCov</span>)<span class="op">;</span></span>
<span id="cb731-48"><a href="supplemental.html#cb731-48" aria-hidden="true" tabindex="-1"></a>  <span class="va">fs</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">model</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb731-49"><a href="supplemental.html#cb731-49" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">fs</span><span class="op">,</span> <span class="ss">&#39;k-&#39;</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">2</span>)</span>
<span id="cb731-50"><a href="supplemental.html#cb731-50" aria-hidden="true" tabindex="-1"></a>  <span class="va">h</span><span class="op">=</span><span class="va">plot</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">ftrain</span><span class="op">,</span> <span class="ss">&#39;kx&#39;</span><span class="op">,</span> <span class="ss">&#39;markersize&#39;</span><span class="op">,</span> <span class="fl">12</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">3</span>)<span class="op">;</span></span>
<span id="cb731-51"><a href="supplemental.html#cb731-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb731-52"><a href="supplemental.html#cb731-52" aria-hidden="true" tabindex="-1"></a><span class="va">printPmtkFigure</span>(<span class="ss">&#39;gprDemoNoiseFreePost&#39;</span>)</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="em.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/supplemental.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
